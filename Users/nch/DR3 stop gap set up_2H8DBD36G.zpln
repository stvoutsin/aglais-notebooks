{
  "paragraphs": [
    {
      "text": "%pyspark\n\nimport gaiadmpsetup\n\nspark.sql(\"CREATE DATABASE gaiadr3\")\n\nspark.sql(\"USE gaiadr3\")\n\n#spark.catalog.listTables()\n\nspark.sql(\"SHOW TABLES\").show()\n",
      "user": "nch",
      "dateUpdated": "2022-07-07 10:41:55.774",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+---------+-----------+\n|database|tableName|isTemporary|\n+--------+---------+-----------+\n+--------+---------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656962661087_2044503250",
      "id": "paragraph_1656962661087_2044503250",
      "dateCreated": "2022-07-04 19:24:21.087",
      "dateStarted": "2022-07-07 10:41:56.375",
      "dateFinished": "2022-07-07 10:42:25.749",
      "status": "FINISHED"
    },
    {
      "title": "Schemas",
      "text": "%pyspark\n\nfrom pyspark.sql.types import *\n\nvari_time_series_statistics_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027num_selected_g_fov\u0027, ShortType(), True), # Total number of G FOV transits selected for variability analysis\n    StructField(\u0027mean_obs_time_g_fov\u0027, DoubleType(), True), # Mean observation time for G FoV transits\n    StructField(\u0027time_duration_g_fov\u0027, FloatType(), True), # Time duration of the time series for G FoV transits\n    StructField(\u0027min_mag_g_fov\u0027, FloatType(), True), # Minimum G FoV magnitude\n    StructField(\u0027max_mag_g_fov\u0027, FloatType(), True), # Maximum G FoV magnitude\n    StructField(\u0027mean_mag_g_fov\u0027, FloatType(), True), # Mean G FoV magnitude\n    StructField(\u0027median_mag_g_fov\u0027, FloatType(), True), # Median G FoV magnitude\n    StructField(\u0027range_mag_g_fov\u0027, FloatType(), True), # Difference between the highest and lowest G FoV magnitudes\n    StructField(\u0027trimmed_range_mag_g_fov\u0027, FloatType(), True), # Trimmed difference between the highest and lowest G FoV magnitudes\n    StructField(\u0027std_dev_mag_g_fov\u0027, FloatType(), True), # Square root of the unweighted G FoV magnitude variance\n    StructField(\u0027skewness_mag_g_fov\u0027, FloatType(), True), # Standardized unweighted G FoV magnitude skewness\n    StructField(\u0027kurtosis_mag_g_fov\u0027, FloatType(), True), # Standardized unweighted G FoV magnitude kurtosis\n    StructField(\u0027mad_mag_g_fov\u0027, FloatType(), True), # Median Absolute Deviation (MAD) for G FoV transits\n    StructField(\u0027abbe_mag_g_fov\u0027, FloatType(), True), # Abbe value for G FoV transits\n    StructField(\u0027iqr_mag_g_fov\u0027, FloatType(), True), # Interquartile range for G FoV transits\n    StructField(\u0027stetson_mag_g_fov\u0027, FloatType(), True), # Stetson G FoV variability index\n    StructField(\u0027std_dev_over_rms_err_mag_g_fov\u0027, FloatType(), True), # Signal-to-Noise G FoV estimate\n    StructField(\u0027outlier_median_g_fov\u0027, FloatType(), True), # Greatest absolute deviation from the G FoV median normalized by the error\n    StructField(\u0027num_selected_bp\u0027, ShortType(), True), # Total number of BP observations selected for variability analysis\n    StructField(\u0027mean_obs_time_bp\u0027, DoubleType(), True), # Mean observation time for BP observations\n    StructField(\u0027time_duration_bp\u0027, FloatType(), True), # Time duration of the BP time series\n    StructField(\u0027min_mag_bp\u0027, FloatType(), True), # Minimum BP magnitude\n    StructField(\u0027max_mag_bp\u0027, FloatType(), True), # Maximum BP magnitude\n    StructField(\u0027mean_mag_bp\u0027, FloatType(), True), # Mean BP magnitude\n    StructField(\u0027median_mag_bp\u0027, FloatType(), True), # Median BP magnitude\n    StructField(\u0027range_mag_bp\u0027, FloatType(), True), # Difference between the highest and lowest BP magnitudes\n    StructField(\u0027trimmed_range_mag_bp\u0027, FloatType(), True), # Trimmed difference between the highest and lowest BP magnitudes\n    StructField(\u0027std_dev_mag_bp\u0027, FloatType(), True), # Square root of the unweighted BP magnitude variance\n    StructField(\u0027skewness_mag_bp\u0027, FloatType(), True), # Standardized unweighted BP magnitude skewness\n    StructField(\u0027kurtosis_mag_bp\u0027, FloatType(), True), # Standardized unweighted BP magnitude kurtosis\n    StructField(\u0027mad_mag_bp\u0027, FloatType(), True), # Median Absolute Deviation (MAD) for BP observations\n    StructField(\u0027abbe_mag_bp\u0027, FloatType(), True), # Abbe value for BP observations\n    StructField(\u0027iqr_mag_bp\u0027, FloatType(), True), # Interquartile BP magnitude range\n    StructField(\u0027stetson_mag_bp\u0027, FloatType(), True), # Stetson BP variability index\n    StructField(\u0027std_dev_over_rms_err_mag_bp\u0027, FloatType(), True), # Signal-to-Noise BP estimate\n    StructField(\u0027outlier_median_bp\u0027, FloatType(), True), # Greatest absolute deviation from the BP median normalized by the error\n    StructField(\u0027num_selected_rp\u0027, ShortType(), True), # Total number of RP observations selected for variability analysis\n    StructField(\u0027mean_obs_time_rp\u0027, DoubleType(), True), # Mean observation time for RP observations\n    StructField(\u0027time_duration_rp\u0027, FloatType(), True), # Time duration of the RP time series\n    StructField(\u0027min_mag_rp\u0027, FloatType(), True), # Minimum RP magnitude\n    StructField(\u0027max_mag_rp\u0027, FloatType(), True), # Maximum RP magnitude\n    StructField(\u0027mean_mag_rp\u0027, FloatType(), True), # Mean RP magnitude\n    StructField(\u0027median_mag_rp\u0027, FloatType(), True), # Median RP magnitude\n    StructField(\u0027range_mag_rp\u0027, FloatType(), True), # Difference between the highest and lowest RP magnitudes\n    StructField(\u0027trimmed_range_mag_rp\u0027, FloatType(), True), # Trimmed difference between the highest and lowest RP magnitudes\n    StructField(\u0027std_dev_mag_rp\u0027, FloatType(), True), # Square root of the unweighted RP magnitude variance\n    StructField(\u0027skewness_mag_rp\u0027, FloatType(), True), # Standardized unweighted RP magnitude skewness\n    StructField(\u0027kurtosis_mag_rp\u0027, FloatType(), True), # Standardized unweighted RP magnitude kurtosis\n    StructField(\u0027mad_mag_rp\u0027, FloatType(), True), # Median Absolute Deviation (MAD) for RP observations\n    StructField(\u0027abbe_mag_rp\u0027, FloatType(), True), # Abbe value for RP observations\n    StructField(\u0027iqr_mag_rp\u0027, FloatType(), True), # Interquartile RP magnitude range\n    StructField(\u0027stetson_mag_rp\u0027, FloatType(), True), # Stetson RP variability index\n    StructField(\u0027std_dev_over_rms_err_mag_rp\u0027, FloatType(), True), # Signal-to-Noise RP estimate\n    StructField(\u0027outlier_median_rp\u0027, FloatType(), True), # Greatest absolute deviation from the RP median normalized by the error\n])\nalerts_mixedin_sourceids_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027alert_source_id\u0027, LongType(), False), # Primary sourceId associated to the alert\n    StructField(\u0027mixed_in_source_id\u0027, LongType(), False), # Additional sourceId, if any, associated to the alert\n])\nastrophysical_parameters_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source Identifier\n    StructField(\u0027classprob_dsc_combmod_quasar\u0027, FloatType(), True), # Probability from DSC-Combmod of being a quasar (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_galaxy\u0027, FloatType(), True), # Probability from DSC-Combmod of being a galaxy (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_star\u0027, FloatType(), True), # Probability from DSC-Combmod of being a single star (but not a white dwarf) (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_whitedwarf\u0027, FloatType(), True), # Probability from DSC-Combmod of being a white dwarf (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_binarystar\u0027, FloatType(), True), # Probability from DSC-Combmod of being a binary star (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_specmod_quasar\u0027, FloatType(), True), # Probability from DSC-Specmod of being a quasar (data used: BP/RP spectrum)\n    StructField(\u0027classprob_dsc_specmod_galaxy\u0027, FloatType(), True), # Probability from DSC-Specmod of being a galaxy (data used: BP/RP spectrum)\n    StructField(\u0027classprob_dsc_specmod_star\u0027, FloatType(), True), # Probability from DSC-Specmod of being a single star (but not a white dwarf) (data used: BP/RP spectrum)\n    StructField(\u0027classprob_dsc_specmod_whitedwarf\u0027, FloatType(), True), # Probability from DSC-Specmod of being a white dwarf (data used: BP/RP spectrum)\n    StructField(\u0027classprob_dsc_specmod_binarystar\u0027, FloatType(), True), # Probability from DSC-Specmod of being a binary star (data used: BP/RP spectrum)\n    StructField(\u0027classprob_dsc_allosmod_quasar\u0027, FloatType(), True), # Probability from DSC-Allosmod of being a quasar (data used: photometry, astrometry)\n    StructField(\u0027classprob_dsc_allosmod_galaxy\u0027, FloatType(), True), # Probability from DSC-Allosmod of being a galaxy (data used: photometry, astrometry)\n    StructField(\u0027classprob_dsc_allosmod_star\u0027, FloatType(), True), # Probability from DSC-Allosmod of being a star (data used: photometry, astrometry)\n    StructField(\u0027teff_gspphot\u0027, FloatType(), True), # Effective temperature from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027teff_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027teff_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logg_gspphot\u0027, FloatType(), True), # Surface gravity from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logg_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logg_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mh_gspphot\u0027, FloatType(), True), # Iron abundance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mh_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of iron abundance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mh_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of iron abundance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027distance_gspphot\u0027, FloatType(), True), # Distance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027distance_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027distance_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027azero_gspphot\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027azero_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027azero_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ag_gspphot\u0027, FloatType(), True), # Extinction in G band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ag_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ag_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027abp_gspphot\u0027, FloatType(), True), # Extinction in $G_{\\rm BP}$ band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027abp_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{\\rm BP}$ band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027abp_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{\\rm BP}$ band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027arp_gspphot\u0027, FloatType(), True), # Extinction in $G_{\\rm RP}$ band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027arp_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{\\rm RP}$ band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027arp_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{\\rm RP}$ band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot\u0027, FloatType(), True), # Reddening $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of reddening  $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of reddening  $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mg_gspphot\u0027, FloatType(), True), # Absolute magnitude $M_{\\rm G}$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mg_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of absolute magnitude $M_{\\rm G}$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mg_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of absolute magnitude $M_{\\rm G}$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027radius_gspphot\u0027, FloatType(), True), # Radius from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027radius_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of radius from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027radius_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of radius from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logposterior_gspphot\u0027, FloatType(), True), # Goodness-of-fit score (mean log-posterior of MCMC) of GSP-Phot Aeneas MCMC best library\n    StructField(\u0027mcmcaccept_gspphot\u0027, FloatType(), True), # MCMC acceptance rate of GSP-Phot Aeneas MCMC best library\n    StructField(\u0027libname_gspphot\u0027, StringType(), True), # Name of library that achieves the highest mean log-posterior in MCMC samples and was used to derive GSP-Phot parameters in this table\n    StructField(\u0027teff_gspspec\u0027, FloatType(), True), # Effective temperature from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations \n    StructField(\u0027teff_gspspec_lower\u0027, FloatType(), True), # 16th percentile of effective temperature from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027teff_gspspec_upper\u0027, FloatType(), True), # 84th percentile of effective temperature from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027logg_gspspec\u0027, FloatType(), True), # Logarithm of the stellar surface gravity from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027logg_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the logarithm of the stellar surface gravity from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027logg_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the logarithm of the stellar surface gravity from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027mh_gspspec\u0027, FloatType(), True), # Global metallicity [M/H] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027mh_gspspec_lower\u0027, FloatType(), True), # 16th percentile of global metallicity [M/H] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027mh_gspspec_upper\u0027, FloatType(), True), # 84th percentile of global metallicity [M/H] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027alphafe_gspspec\u0027, FloatType(), True), # Abundance of alpha-elements [alpha/Fe] with respect to iron from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027alphafe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of alpha-elements [alpha/Fe] with respect to iron from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027alphafe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of alpha-elements [alpha/Fe] with respect to iron from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027fem_gspspec\u0027, FloatType(), True), # Abundance of neutral iron [Fe/M] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt femGspspecNlines}\n    StructField(\u0027fem_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of neutral iron [Fe/M] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027fem_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of neutral iron [Fe/M] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027fem_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Fe/M] abundance estimation\n    StructField(\u0027fem_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Fe/M] abundance using N lines of the element, given in {\\tt femGspspecNlines}\n    StructField(\u0027sife_gspspec\u0027, FloatType(), True), # Abundance of Silicon [Si/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt sifeGspspecNlines}\n    StructField(\u0027sife_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of silicon [Si/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations \n    StructField(\u0027sife_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of silicon [Si/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027sife_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Si/Fe] abundance estimation\n    StructField(\u0027sife_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Si/Fe] abundance using N lines of the element, given in {\\tt sifeGspspecNlines}\n    StructField(\u0027cafe_gspspec\u0027, FloatType(), True), # Abundance of Calcium [Ca/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt cafeGspspecNlines}\n    StructField(\u0027cafe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Calcium [Ca/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027cafe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Calcium [Ca/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027cafe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Ca/Fe] abundance estimation\n    StructField(\u0027cafe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Ca/Fe] abundance using N lines of the element, given in {\\tt cafeGspspecNlines}\n    StructField(\u0027tife_gspspec\u0027, FloatType(), True), # Abundance of Titanium [Ti/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt tifeGspspecNlines}  \n    StructField(\u0027tife_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Titanium [Ti/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027tife_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Titanium [Ti/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027tife_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Ti/Fe] abundance estimation\n    StructField(\u0027tife_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Ti/Fe] abundance using N lines of the element, given in {\\tt tifeGspspecNlines}\n    StructField(\u0027mgfe_gspspec\u0027, FloatType(), True), # Abundance of Magnesium [Mg/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt mgfeGspspecNlines}\n    StructField(\u0027mgfe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Magnesium [Mg/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027mgfe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Magnesium [Mg/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations \n    StructField(\u0027mgfe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Mg/Fe] abundance estimation\n    StructField(\u0027mgfe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Mg/Fe] abundance using N lines of the element, given in {\\tt mgfeGspspecNlines}\n    StructField(\u0027ndfe_gspspec\u0027, FloatType(), True), # Abundance of neodymium [Nd/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt ndfeGspspecNlines}\n    StructField(\u0027ndfe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of neodymium [Nd/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027ndfe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of neodymium [Nd/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027ndfe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Nd/Fe] abundance estimation\n    StructField(\u0027ndfe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Nd/Fe] abundance using N lines of the element, given in {\\tt ndfeGspspecNlines}\n    StructField(\u0027feiim_gspspec\u0027, FloatType(), True), # Abundance of ionised iron [FeII/M] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt feiimGspspecNlines}\n    StructField(\u0027feiim_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of ionised iron [FeII/M] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027feiim_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of ionised iron [FeII/M] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027feiim_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [FeII/M] abundance estimation\n    StructField(\u0027feiim_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [FeII/M] abundance using N lines of the element, given in {\\tt feiimGspspecNlines}\n    StructField(\u0027sfe_gspspec\u0027, FloatType(), True), # Abundance of Sulphur [S/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt sfeGspspecNlines}\n    StructField(\u0027sfe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Sulphur [S/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027sfe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Sulphur [S/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027sfe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [S/Fe] abundance estimation\n    StructField(\u0027sfe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [S/Fe] abundance using N lines of the element, given in {\\tt sfeGspspecNlines}\n    StructField(\u0027zrfe_gspspec\u0027, FloatType(), True), # Abundance of Zirconium [Zr/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt zrfeGspspecNlines}\n    StructField(\u0027zrfe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Zirconium [Zr/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027zrfe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Zirconium [Zr/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027zrfe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Zr/Fe] abundance estimation\n    StructField(\u0027zrfe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Zr/Fe] abundance using N lines of the element, given in {\\tt zrfeGspspecNlines}\n    StructField(\u0027nfe_gspspec\u0027, FloatType(), True), # Abundance of Nitrogen [N/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt nfeGspspecNlines}\n    StructField(\u0027nfe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Nitrogen [N/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027nfe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Nitrogen [N/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027nfe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [N/Fe] abundance estimation\n    StructField(\u0027nfe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [N/Fe] abundance using N lines of the element, given in {\\tt nfeGspspecNlines}\n    StructField(\u0027crfe_gspspec\u0027, FloatType(), True), # Abundance of Chromium [Cr/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt crfeGspspecNlines}\n    StructField(\u0027crfe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Chromium [Cr/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027crfe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Chromium [Cr/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027crfe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Cr/Fe] abundance estimation\n    StructField(\u0027crfe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Cr/Fe] abundance using N lines of the element, given in {\\tt crfeGspspecNlines}\n    StructField(\u0027cefe_gspspec\u0027, FloatType(), True), # Abundance of Cerium [Ce/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt cefeGspspecNlines}\n    StructField(\u0027cefe_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Cerium [Ce/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027cefe_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Cerium [Ce/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027cefe_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Ce/Fe] abundance estimation\n    StructField(\u0027cefe_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Ce/Fe] abundance using N lines of the element, given in {\\tt cefeGspspecNlines}\n    StructField(\u0027nife_gspspec\u0027, FloatType(), True), # Abundance of Nickel [Ni/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations, applied to the individual N lines of the element, given in {\\tt nifeGspspecNlines}\n    StructField(\u0027nife_gspspec_lower\u0027, FloatType(), True), # 16th percentile of the abundance of Nickel [Ni/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027nife_gspspec_upper\u0027, FloatType(), True), # 84th percentile of the abundance of Nickel [Ni/Fe] from GSP-Spec MatisseGauguin using RVS spectra and Monte Carlo realisations\n    StructField(\u0027nife_gspspec_nlines\u0027, IntegerType(), True), # Number of lines used for [Ni/Fe] abundance estimation\n    StructField(\u0027nife_gspspec_linescatter\u0027, FloatType(), True), # Uncertainty estimation of [Ni/Fe] abundance using N lines of the element, given in {\\tt nifeGspspecNlines}\n    StructField(\u0027cn0ew_gspspec\u0027, FloatType(), True), # Equivalent witdh of cyanogen absorption line, derived from RVS spectra\n    StructField(\u0027cn0ew_gspspec_uncertainty\u0027, FloatType(), True), # Uncertainty of equivalent witdh of cyanogen absorption line, derived from RVS spectra\n    StructField(\u0027cn0_gspspec_centralline\u0027, FloatType(), True), # Central wavelength of cyanogen line, derived from RVS spectra using DIB algorithm\n    StructField(\u0027cn0_gspspec_width\u0027, FloatType(), True), # Width of cyoanogen line, derived from RVS spectra using DIB algorithm\n    StructField(\u0027dib_gspspec_lambda\u0027, FloatType(), True), # DIB central wavelength from GSP-Spec MatisseGauguin using RVS spectra \n    StructField(\u0027dib_gspspec_lambda_uncertainty\u0027, FloatType(), True), # Uncertainty on DIB central wavelength from GSP-Spec MatisseGauguin using RVS spectra\n    StructField(\u0027dibew_gspspec\u0027, FloatType(), True), # Equivalent width of the DIB from GSP-Spec MatisseGauguin using RVS spectra\n    StructField(\u0027dibew_gspspec_uncertainty\u0027, FloatType(), True), # Global uncertainty on DIB equivalent width value using DIB algorithm \n    StructField(\u0027dibewnoise_gspspec_uncertainty\u0027, FloatType(), True), # Uncertainty on DIB equivalent width value occuring from noise part \n    StructField(\u0027dibp0_gspspec\u0027, FloatType(), True), # Depth ($p_0$ parameter) of the DIB derived from a Gaussian model fit\n    StructField(\u0027dibp2_gspspec\u0027, FloatType(), True), # Width ($p_2$ parameter) of the DIB derived from a Gaussian model fit\n    StructField(\u0027dibp2_gspspec_uncertainty\u0027, FloatType(), True), # Uncertainty on the {\\tt dibp2Gspspec} parameter \n    StructField(\u0027dibqf_gspspec\u0027, IntegerType(), True), # Quality flag of the DIB computation\n    StructField(\u0027flags_gspspec\u0027, StringType(), True), # Catalogue flags for GSP-Spec MatisseGauguin \n    StructField(\u0027logchisq_gspspec\u0027, FloatType(), True), # Logarithm of the goodness-of-fit for the GSP-Spec MatisseGauguin parameters\n    StructField(\u0027ew_espels_halpha\u0027, FloatType(), True), # Halpha pseudo-equivalent width from ESP-ELS\n    StructField(\u0027ew_espels_halpha_uncertainty\u0027, FloatType(), True), # Uncertainty of the Halpha pseudo-equivalent width from ESP-ELS\n    StructField(\u0027ew_espels_halpha_flag\u0027, StringType(), True), # Quality flag of the Halpha pseudo-equivalent width from ESP-ELS\n    StructField(\u0027ew_espels_halpha_model\u0027, FloatType(), True), # Halpha pseudo-equivalent width from ESP-ELS measured on the synthetic spectrum\n    StructField(\u0027classlabel_espels\u0027, StringType(), True), # Adopted ELS class label from ESP-ELS\n    StructField(\u0027classlabel_espels_flag\u0027, StringType(), True), # Quality flag of the adopted ELS class label from ESP-ELS\n    StructField(\u0027classprob_espels_wcstar\u0027, FloatType(), True), # Probability from ESP-ELS of being a Wolf-Rayet star of type WC\n    StructField(\u0027classprob_espels_wnstar\u0027, FloatType(), True), # Probability from ESP-ELS of being a Wolf-Rayet star of type WN\n    StructField(\u0027classprob_espels_bestar\u0027, FloatType(), True), # Probability from ESP-ELS of being a Be Star\n    StructField(\u0027classprob_espels_ttauristar\u0027, FloatType(), True), # Probability from ESP-ELS of being a T Tauri Star\n    StructField(\u0027classprob_espels_herbigstar\u0027, FloatType(), True), # Probability from ESP-ELS of being a Herbig Ae/Be Star\n    StructField(\u0027classprob_espels_dmestar\u0027, FloatType(), True), # Probability from ESP-ELS of being an active M dwarf Star\n    StructField(\u0027classprob_espels_pne\u0027, FloatType(), True), # Probability from ESP-ELS of being a planetary nebula\n    StructField(\u0027azero_esphs\u0027, FloatType(), True), # Monochromatic interstellar extinction, A$_\\mathrm{0}$, from ESP-HS\n    StructField(\u0027azero_esphs_uncertainty\u0027, FloatType(), True), # Uncertainty at a 68% confidence level on A$_\\mathrm{0}$ from ESP-HS\n    StructField(\u0027ag_esphs\u0027, FloatType(), True), # Intersterstellar extinction in G band from ESP-HS\n    StructField(\u0027ag_esphs_uncertainty\u0027, FloatType(), True), # Uncertainty on $A_{\\rm G}$ from ESP-HS\n    StructField(\u0027ebpminrp_esphs\u0027, FloatType(), True), # Reddening $E(G_{\\rm BP} - G_{\\rm RP})$ from ESP-HS\n    StructField(\u0027ebpminrp_esphs_uncertainty\u0027, FloatType(), True), # Uncertainty on $E(G_{\\rm BP} - G_{\\rm RP})$ from ESP-HS\n    StructField(\u0027teff_esphs\u0027, FloatType(), True), # Effective temperature from ESP-HS\n    StructField(\u0027teff_esphs_uncertainty\u0027, FloatType(), True), # Uncertainty at a 68% confidence level on the effective temperature from ESP-HS\n    StructField(\u0027logg_esphs\u0027, FloatType(), True), # Surface gravity from ESP-HS\n    StructField(\u0027logg_esphs_uncertainty\u0027, FloatType(), True), # Uncertainty at a 68% confidence level on the surface gravity from ESP-HS\n    StructField(\u0027vsini_esphs\u0027, FloatType(), True), # Projected rotational velocity from ESP-HS\n    StructField(\u0027vsini_esphs_uncertainty\u0027, FloatType(), True), # Uncertainty on the projected rotational velocity from ESP-HS\n    StructField(\u0027flags_esphs\u0027, StringType(), True), # Quality flag of the ESP-HS parametrisation\n    StructField(\u0027spectraltype_esphs\u0027, StringType(), True), # Spectral type from ESP-ELS\n    StructField(\u0027activityindex_espcs\u0027, FloatType(), True), # Chromospheric activity index from ESP-CS, measured on the calcium triplet using RVS spectra\n    StructField(\u0027activityindex_espcs_uncertainty\u0027, FloatType(), True), # Uncertainty in the chromospheric activity index from ESP-CS\n    StructField(\u0027activityindex_espcs_input\u0027, StringType(), True), # Source of input stellar parameters for the computation of the activity index by ESP-CS\n    StructField(\u0027teff_espucd\u0027, FloatType(), True), # Effective temperature estimate from ESP-UCD based on the RP spectrum\n    StructField(\u0027teff_espucd_uncertainty\u0027, FloatType(), True), # Uncertainty of the effective temperature estimate produced by ESP-UCD \n    StructField(\u0027flags_espucd\u0027, StringType(), True), # Quality flags of the ESP-UCD parameter estimates\n    StructField(\u0027radius_flame\u0027, FloatType(), True), # Radius of the star from FLAME using {\\tt teffGspphot} and {\\tt lumFlame}\n    StructField(\u0027radius_flame_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt radiusFlame}\n    StructField(\u0027radius_flame_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt radiusFlame}\n    StructField(\u0027lum_flame\u0027, FloatType(), True), # Luminosity of the star from FLAME using G band magnitude, extinction ({\\tt agGspphot}),  parallax or distance, and a bolometric correction {\\tt bcFlame}\n    StructField(\u0027lum_flame_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt lumFlame}\n    StructField(\u0027lum_flame_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt lumFlame}\n    StructField(\u0027mass_flame\u0027, FloatType(), True), # Mass of the star from FLAME using stellar models, {\\tt lumFlame}, and {\\tt teffGspphot}\n    StructField(\u0027mass_flame_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt massFlame}\n    StructField(\u0027mass_flame_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt massFlame}\n    StructField(\u0027age_flame\u0027, FloatType(), True), # Age of the star from FLAME using stellar models, see {\\tt massFlame} for details\n    StructField(\u0027age_flame_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt ageFlame}\n    StructField(\u0027age_flame_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt ageFlame} \n    StructField(\u0027flags_flame\u0027, StringType(), True), # Flags indicating quality and processing information from FLAME\n    StructField(\u0027evolstage_flame\u0027, IntegerType(), True), # Evolutionary stage of the star from FLAME using stellar models, see {\\tt massFlame} for details\n    StructField(\u0027gravredshift_flame\u0027, FloatType(), True), # Gravitational redshift from FLAME using {\\tt radiusFlame} and {\\tt loggGspphot}\n    StructField(\u0027gravredshift_flame_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt gravredshiftFlame}\n    StructField(\u0027gravredshift_flame_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt gravredshiftFlame}\n    StructField(\u0027bc_flame\u0027, FloatType(), True), # Bolometric correction used to derive {\\tt lumFlame}\n    StructField(\u0027mh_msc\u0027, FloatType(), True), # Metallicity of the source treated as a binary system from MSC using BP/RP spectra and parallax\n    StructField(\u0027mh_msc_upper\u0027, FloatType(), True), # Upper confidence level (84%) of the metallicity from MSC using BP/RP spectra and parallax\n    StructField(\u0027mh_msc_lower\u0027, FloatType(), True), # Lower confidence level (16%) of the metallicity from MSC using BP/RP spectra and parallax\n    StructField(\u0027azero_msc\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm of the source treated as a binary system from MSC using BP/RP spectra and parallax\n    StructField(\u0027azero_msc_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from MSC using BP/RP spectra and parallax\n    StructField(\u0027azero_msc_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from MSC using BP/RP spectra and parallax\n    StructField(\u0027distance_msc\u0027, FloatType(), True), # Distance from MSC using BP/RP spectra and parallax\n    StructField(\u0027distance_msc_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from MSC using BP/RP spectra and parallax\n    StructField(\u0027distance_msc_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from MSC using BP/RP spectra and parallax\n    StructField(\u0027teff_msc1\u0027, FloatType(), True), # Effective temperature of the primary from MSC using BP/RP spectra and parallax\n    StructField(\u0027teff_msc1_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature of the primary from MSC using BP/RP spectra and parallax\n    StructField(\u0027teff_msc1_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature of the primary from MSC using BP/RP spectra and parallax\n    StructField(\u0027teff_msc2\u0027, FloatType(), True), # Effective temperature of the secondary from MSC using BP/RP spectra and parallax\n    StructField(\u0027teff_msc2_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature of the secondary from MSC using BP/RP spectra and parallax\n    StructField(\u0027teff_msc2_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature of the secondary from MSC using BP/RP spectra and parallax\n    StructField(\u0027logg_msc1\u0027, FloatType(), True), # Surface gravity of the primary from MSC using BP/RP spectra and parallax\n    StructField(\u0027logg_msc1_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity of the primary from MSC using BP/RP spectra and parallax\n    StructField(\u0027logg_msc1_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity of the primary from MSC using BP/RP spectra and parallax\n    StructField(\u0027logg_msc2\u0027, FloatType(), True), # Surface gravity of the secondary from MSC using BP/RP spectra and parallax\n    StructField(\u0027logg_msc2_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity of the secondary from MSC using BP/RP spectra and parallax\n    StructField(\u0027logg_msc2_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity of the secondary from MSC using BP/RP spectra and parallax\n    StructField(\u0027ag_msc\u0027, FloatType(), True), # Extinction in G band of the source treated as a binary system from MSC using BP/RP spectra and parallax\n    StructField(\u0027ag_msc_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from MSC using BP/RP spectra and parallax\n    StructField(\u0027ag_msc_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from MSC using BP/RP spectra and parallax\n    StructField(\u0027logposterior_msc\u0027, FloatType(), True), # Goodness-of-fit score (normalised log-posterior) of MSC MCMC\n    StructField(\u0027mcmcaccept_msc\u0027, FloatType(), True), # Mean MCMC acceptance rate of MSC MCMC\n    StructField(\u0027mcmcdrift_msc\u0027, FloatType(), True), # Mean drift of the MSC MCMC chain in units of parameter standard deviation\n    StructField(\u0027flags_msc\u0027, StringType(), True), # Flag indicating quality information from MSC\n    StructField(\u0027neuron_oa_id\u0027, LongType(), True), # Identifier of the OA SOM map neuron that represents the source\n    StructField(\u0027neuron_oa_dist\u0027, FloatType(), True), # Distance between the source XP spectra and the OA neuron XP prototype that represents the source\n    StructField(\u0027neuron_oa_dist_percentile_rank\u0027, IntegerType(), True), # Percentile rank according to the distance distribution of the OA neuron that represents the source\n    StructField(\u0027flags_oa\u0027, StringType(), True), # Flags indicating quality and processing information from OA\n])\nastrophysical_parameters_supp_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source Identifier\n    StructField(\u0027libname_best_gspphot\u0027, StringType(), True), # Name of library that achieves the highest mean log-posterior in MCMC samples from GSP-Phot Aeneas\n    StructField(\u0027teff_gspphot_marcs\u0027, FloatType(), True), # Effective temperature from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027teff_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027teff_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027logg_gspphot_marcs\u0027, FloatType(), True), # Surface gravity from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027logg_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027logg_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027mh_gspphot_marcs\u0027, FloatType(), True), # Iron abundance from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027mh_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of iron abundance from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027mh_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of iron abundance from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027distance_gspphot_marcs\u0027, FloatType(), True), # Distance from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027distance_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027distance_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027azero_gspphot_marcs\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027azero_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027azero_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027ag_gspphot_marcs\u0027, FloatType(), True), # Extinction in G band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027ag_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027ag_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027abp_gspphot_marcs\u0027, FloatType(), True), # Extinction in $G_{BP}$ band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027abp_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027abp_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027arp_gspphot_marcs\u0027, FloatType(), True), # Extinction in $G_{RP}$ band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027arp_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027arp_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_marcs\u0027, FloatType(), True), # Reddening $E(BP-RP)$ from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of reddening  $E(BP-RP)$ from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of reddening  $E(BP-RP)$ from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027mg_gspphot_marcs\u0027, FloatType(), True), # Absolute magnitude $M_G$ from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027mg_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027mg_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027radius_gspphot_marcs\u0027, FloatType(), True), # Radius from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027radius_gspphot_marcs_lower\u0027, FloatType(), True), # Lower confidence level (16%) of radius from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027radius_gspphot_marcs_upper\u0027, FloatType(), True), # Upper confidence level (84%) of radius from GSP-Phot Aeneas for MARCS library using BP/RP spectra\n    StructField(\u0027logposterior_gspphot_marcs\u0027, FloatType(), True), # Goodness-of-fit score (mean log-posterior of MCMC) of GSP-Phot Aeneas MCMC for MARCS library\n    StructField(\u0027mcmcaccept_gspphot_marcs\u0027, FloatType(), True), # MCMC acceptance rate of GSP-Phot Aeneas MCMC for MARCS library\n    StructField(\u0027teff_gspphot_phoenix\u0027, FloatType(), True), # Effective temperature from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027teff_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027teff_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027logg_gspphot_phoenix\u0027, FloatType(), True), # Surface gravity from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027logg_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027logg_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027mh_gspphot_phoenix\u0027, FloatType(), True), # Iron abundance from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027mh_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of iron abundance from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027mh_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of iron abundance from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027distance_gspphot_phoenix\u0027, FloatType(), True), # Distance from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027distance_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027distance_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027azero_gspphot_phoenix\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027azero_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027azero_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027ag_gspphot_phoenix\u0027, FloatType(), True), # Extinction in G band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027ag_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027ag_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027abp_gspphot_phoenix\u0027, FloatType(), True), # Extinction in $G_{BP}$ band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027abp_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027abp_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027arp_gspphot_phoenix\u0027, FloatType(), True), # Extinction in $G_{RP}$ band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027arp_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027arp_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_phoenix\u0027, FloatType(), True), # Reddening $E(BP-RP)$ from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of reddening  $E(BP-RP)$ from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of reddening  $E(BP-RP)$ from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027mg_gspphot_phoenix\u0027, FloatType(), True), # Absolute magnitude $M_G$ from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027mg_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027mg_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027radius_gspphot_phoenix\u0027, FloatType(), True), # Radius from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027radius_gspphot_phoenix_lower\u0027, FloatType(), True), # Lower confidence level (16%) of radius from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027radius_gspphot_phoenix_upper\u0027, FloatType(), True), # Upper confidence level (84%) of radius from GSP-Phot Aeneas for PHOENIX library using BP/RP spectra\n    StructField(\u0027logposterior_gspphot_phoenix\u0027, FloatType(), True), # Goodness-of-fit score (mean log-posterior of MCMC) of GSP-Phot Aeneas MCMC for PHOENIX library\n    StructField(\u0027mcmcaccept_gspphot_phoenix\u0027, FloatType(), True), # MCMC acceptance rate of GSP-Phot Aeneas MCMC for PHOENIX library\n    StructField(\u0027teff_gspphot_ob\u0027, FloatType(), True), # Effective temperature from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027teff_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027teff_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027logg_gspphot_ob\u0027, FloatType(), True), # Surface gravity from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027logg_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027logg_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027mh_gspphot_ob\u0027, FloatType(), True), # Iron abundance from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027mh_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of iron abundance from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027mh_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of iron abundance from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027distance_gspphot_ob\u0027, FloatType(), True), # Distance from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027distance_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027distance_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027azero_gspphot_ob\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027azero_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027azero_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027ag_gspphot_ob\u0027, FloatType(), True), # Extinction in G band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027ag_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027ag_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027abp_gspphot_ob\u0027, FloatType(), True), # Extinction in $G_{BP}$ band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027abp_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027abp_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027arp_gspphot_ob\u0027, FloatType(), True), # Extinction in $G_{RP}$ band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027arp_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027arp_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_ob\u0027, FloatType(), True), # Reddening E(BP-RP) from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of reddening  E(BP-RP) from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of reddening  E(BP-RP) from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027mg_gspphot_ob\u0027, FloatType(), True), # Absolute magnitude $M_G$ from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027mg_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027mg_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027radius_gspphot_ob\u0027, FloatType(), True), # Radius from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027radius_gspphot_ob_lower\u0027, FloatType(), True), # Lower confidence level (16%) of radius from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027radius_gspphot_ob_upper\u0027, FloatType(), True), # Upper confidence level (84%) of radius from GSP-Phot Aeneas for OB library using BP/RP spectra\n    StructField(\u0027logposterior_gspphot_ob\u0027, FloatType(), True), # Goodness-of-fit score (mean log-posterior of MCMC) of GSP-Phot Aeneas MCMC for OB library\n    StructField(\u0027mcmcaccept_gspphot_ob\u0027, FloatType(), True), # MCMC acceptance rate of GSP-Phot Aeneas MCMC for OB library\n    StructField(\u0027teff_gspphot_a\u0027, FloatType(), True), # Effective temperature from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027teff_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027teff_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027logg_gspphot_a\u0027, FloatType(), True), # Surface gravity from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027logg_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027logg_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027mh_gspphot_a\u0027, FloatType(), True), # Iron abundance from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027mh_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of iron abundance from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027mh_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of iron abundance from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027distance_gspphot_a\u0027, FloatType(), True), # Distance from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027distance_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027distance_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027azero_gspphot_a\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027azero_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027azero_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027ag_gspphot_a\u0027, FloatType(), True), # Extinction in G band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027ag_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027ag_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027abp_gspphot_a\u0027, FloatType(), True), # Extinction in $G_{BP}$ band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027abp_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027abp_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{BP}$ band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027arp_gspphot_a\u0027, FloatType(), True), # Extinction in $G_{RP}$ band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027arp_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027arp_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in $G_{RP}$ band from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_a\u0027, FloatType(), True), # Reddening $E(BP-RP)$ from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of reddening  $E(BP-RP)$ from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of reddening  $E(BP-RP)$ from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027mg_gspphot_a\u0027, FloatType(), True), # Absolute magnitude $M_G$ from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027mg_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027mg_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of absolute magnitude $M_G$ from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027radius_gspphot_a\u0027, FloatType(), True), # Radius from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027radius_gspphot_a_lower\u0027, FloatType(), True), # Lower confidence level (16%) of radius from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027radius_gspphot_a_upper\u0027, FloatType(), True), # Upper confidence level (84%) of radius from GSP-Phot Aeneas for A library using BP/RP spectra\n    StructField(\u0027logposterior_gspphot_a\u0027, FloatType(), True), # Goodness-of-fit score (mean log-posterior of MCMC) of GSP-Phot Aeneas MCMC for A library\n    StructField(\u0027mcmcaccept_gspphot_a\u0027, FloatType(), True), # MCMC acceptance rate of GSP-Phot Aeneas MCMC for A library\n    StructField(\u0027teff_gspspec_ann\u0027, FloatType(), True), # Effective temperature from GSP-Spec ANN using RVS spectra and Monte Carlo realisations \n    StructField(\u0027teff_gspspec_ann_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027teff_gspspec_ann_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027logg_gspspec_ann\u0027, FloatType(), True), # Surface gravity from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027logg_gspspec_ann_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Spec ANN using RVS spectra and Monte Carlo realisations \n    StructField(\u0027logg_gspspec_ann_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Spec ANN using RVS spectra and Monte Carlo realisations \n    StructField(\u0027mh_gspspec_ann\u0027, FloatType(), True), # Global metallicity from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027mh_gspspec_ann_lower\u0027, FloatType(), True), # Lower confidence level (16%) of global metallicity from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027mh_gspspec_ann_upper\u0027, FloatType(), True), # Upper confidence level (84%) of global metallicity  from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027alphafe_gspspec_ann\u0027, FloatType(), True), # Abundance of alpha-elements with respect to iron from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027alphafe_gspspec_ann_lower\u0027, FloatType(), True), # Lower confidence level (16%) of alpha-elements with respect to iron from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027alphafe_gspspec_ann_upper\u0027, FloatType(), True), # Upper confidence level (84%) of alpha-elements with respect to iron from GSP-Spec ANN using RVS spectra and Monte Carlo realisations\n    StructField(\u0027logchisq_gspspec_ann\u0027, FloatType(), True), # Logarithm of the goodness-of-fit for the GSP-Spec ANN parameters\n    StructField(\u0027flags_gspspec_ann\u0027, StringType(), True), # Catalogue flags for GSP-Spec ANN\n    StructField(\u0027radius_flame_spec\u0027, FloatType(), True), # Radius of the star from FLAME using {\\tt teffGspspec} and {\\tt lumFlameSpec}\n    StructField(\u0027radius_flame_spec_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt radiusFlameSpec}\n    StructField(\u0027radius_flame_spec_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt radiusFlameSpec}\n    StructField(\u0027lum_flame_spec\u0027, FloatType(), True), # Luminosity of the star from FLAME using G band magnitude, extinction ({\\tt agGspphot}),  parallax and a bolometric correction {\\tt bcFlameSpec}\n    StructField(\u0027lum_flame_spec_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt lumFlameSpec}\n    StructField(\u0027lum_flame_spec_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt lumFlameSpec} \n    StructField(\u0027mass_flame_spec\u0027, FloatType(), True), # Mass of the star from FLAME using stellar models,  {\\tt lumFlameSpec} and {\\tt teffGspspec}\n    StructField(\u0027mass_flame_spec_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt massFlameSpec}\n    StructField(\u0027mass_flame_spec_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt massFlameSpec}\n    StructField(\u0027age_flame_spec\u0027, FloatType(), True), # Age of the star from FLAME using stellar models, see {\\tt massFlameSpec} for details\n    StructField(\u0027age_flame_spec_lower\u0027, FloatType(), True), # Lower confidence level (16%) of {\\tt ageFlameSpec}\n    StructField(\u0027age_flame_spec_upper\u0027, FloatType(), True), # Upper confidence level (84%) of {\\tt ageFlameSpec}\n    StructField(\u0027flags_flame_spec\u0027, StringType(), True), # Flag indicating quality of parameters from FLAME using GSP-Spec parameters\n    StructField(\u0027evolstage_flame_spec\u0027, IntegerType(), True), # Evolutionary stage of the star from FLAME using stellar models, see {\\tt massFlameSpec} for details\n    StructField(\u0027gravredshift_flame_spec\u0027, FloatType(), True), # Gravitational redshift from FLAME using GSP-Spec parameters\n    StructField(\u0027gravredshift_flame_spec_lower\u0027, FloatType(), True), # Lower confidence interval of {\\tt gravredshiftFlameSpec}\n    StructField(\u0027gravredshift_flame_spec_upper\u0027, FloatType(), True), # Upper confidence interval of {\\tt gravredshiftFlameSpec}\n    StructField(\u0027bc_flame_spec\u0027, FloatType(), True), # Bolometric correction applied to derive {\\tt lumFlameSpec} using GSP-Spec parameters\n])\nepoch_photometry_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027n_transits\u0027, ShortType(), True), # Number of Gaia transits\n    StructField(\u0027transit_id\u0027, ArrayType(LongType()), True), # Transit unique identifier\n    StructField(\u0027g_transit_time\u0027, ArrayType(DoubleType()), True), # Transit averaged G band observing time\n    StructField(\u0027g_transit_flux\u0027, ArrayType(DoubleType()), True), # Transit averaged G band flux\n    StructField(\u0027g_transit_flux_error\u0027, ArrayType(DoubleType()), True), # Transit averaged G band flux error\n    StructField(\u0027g_transit_flux_over_error\u0027, ArrayType(FloatType()), True), # Transit averaged G band flux divided by its error\n    StructField(\u0027g_transit_mag\u0027, ArrayType(DoubleType()), True), # Transit averaged G band Vega magnitude\n    StructField(\u0027g_transit_n_obs\u0027, ArrayType(ByteType()), True), # Number of CCD observations contributing to transit averaged G band flux\n    StructField(\u0027bp_obs_time\u0027, ArrayType(DoubleType()), True), # BP CCD transit observing time\n    StructField(\u0027bp_flux\u0027, ArrayType(DoubleType()), True), # BP band flux\n    StructField(\u0027bp_flux_error\u0027, ArrayType(DoubleType()), True), # BP band flux error\n    StructField(\u0027bp_flux_over_error\u0027, ArrayType(FloatType()), True), # BP band flux divided by its error\n    StructField(\u0027bp_mag\u0027, ArrayType(DoubleType()), True), # BP band Vega magnitude\n    StructField(\u0027rp_obs_time\u0027, ArrayType(DoubleType()), True), # RP CCD transit observing time\n    StructField(\u0027rp_flux\u0027, ArrayType(DoubleType()), True), # RP band flux\n    StructField(\u0027rp_flux_error\u0027, ArrayType(DoubleType()), True), # RP band flux error\n    StructField(\u0027rp_flux_over_error\u0027, ArrayType(FloatType()), True), # RP band flux divided by its error\n    StructField(\u0027rp_mag\u0027, ArrayType(DoubleType()), True), # RP band Vega magnitude\n    StructField(\u0027photometry_flag_noisy_data\u0027, ArrayType(BooleanType()), True), # G band flux scatter larger than expected by photometry processing (all CCDs considered)\n    StructField(\u0027photometry_flag_sm_unavailable\u0027, ArrayType(BooleanType()), True), # SM transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af1_unavailable\u0027, ArrayType(BooleanType()), True), # AF1 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af2_unavailable\u0027, ArrayType(BooleanType()), True), # AF2 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af3_unavailable\u0027, ArrayType(BooleanType()), True), # AF3 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af4_unavailable\u0027, ArrayType(BooleanType()), True), # AF4 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af5_unavailable\u0027, ArrayType(BooleanType()), True), # AF5 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af6_unavailable\u0027, ArrayType(BooleanType()), True), # AF6 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af7_unavailable\u0027, ArrayType(BooleanType()), True), # AF7 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af8_unavailable\u0027, ArrayType(BooleanType()), True), # AF8 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_af9_unavailable\u0027, ArrayType(BooleanType()), True), # AF9 transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_bp_unavailable\u0027, ArrayType(BooleanType()), True), # BP transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_rp_unavailable\u0027, ArrayType(BooleanType()), True), # RP transit unavailable by photometry processing\n    StructField(\u0027photometry_flag_sm_reject\u0027, ArrayType(BooleanType()), True), # SM transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af1_reject\u0027, ArrayType(BooleanType()), True), # AF1 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af2_reject\u0027, ArrayType(BooleanType()), True), # AF2 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af3_reject\u0027, ArrayType(BooleanType()), True), # AF3 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af4_reject\u0027, ArrayType(BooleanType()), True), # AF4 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af5_reject\u0027, ArrayType(BooleanType()), True), # AF5 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af6_reject\u0027, ArrayType(BooleanType()), True), # AF6 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af7_reject\u0027, ArrayType(BooleanType()), True), # AF7 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af8_reject\u0027, ArrayType(BooleanType()), True), # AF8 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_af9_reject\u0027, ArrayType(BooleanType()), True), # AF9 transit rejected by photometry processing\n    StructField(\u0027photometry_flag_bp_reject\u0027, ArrayType(BooleanType()), True), # BP transit rejected by photometry processing\n    StructField(\u0027photometry_flag_rp_reject\u0027, ArrayType(BooleanType()), True), # RP transit rejected by photometry processing\n    StructField(\u0027variability_flag_g_reject\u0027, ArrayType(BooleanType()), True), # Average G transit photometry rejected by variability processing\n    StructField(\u0027variability_flag_bp_reject\u0027, ArrayType(BooleanType()), True), # BP transit photometry rejected by variability processing\n    StructField(\u0027variability_flag_rp_reject\u0027, ArrayType(BooleanType()), True), # RP transit photometry rejected by variability processing\n])\ngaia_source_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027designation\u0027, StringType(), True), # Unique source designation (unique across all Data Releases)\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027random_index\u0027, LongType(), True), # Random index for use when selecting subsets\n    StructField(\u0027ref_epoch\u0027, DoubleType(), True), # Reference epoch\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right ascension\n    StructField(\u0027ra_error\u0027, FloatType(), True), # Standard error of right ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027dec_error\u0027, FloatType(), True), # Standard error of declination\n    StructField(\u0027parallax\u0027, DoubleType(), True), # Parallax\n    StructField(\u0027parallax_error\u0027, FloatType(), True), # Standard error of parallax\n    StructField(\u0027parallax_over_error\u0027, FloatType(), True), # Parallax divided by its standard error\n    StructField(\u0027pm\u0027, FloatType(), True), # Total proper motion\n    StructField(\u0027pmra\u0027, DoubleType(), True), # Proper motion in right ascension direction\n    StructField(\u0027pmra_error\u0027, FloatType(), True), # Standard error of proper motion in right ascension direction\n    StructField(\u0027pmdec\u0027, DoubleType(), True), # Proper motion in declination direction\n    StructField(\u0027pmdec_error\u0027, FloatType(), True), # Standard error of proper motion in declination direction\n    StructField(\u0027ra_dec_corr\u0027, FloatType(), True), # Correlation between right ascension and declination\n    StructField(\u0027ra_parallax_corr\u0027, FloatType(), True), # Correlation between right ascension and parallax\t\t\n    StructField(\u0027ra_pmra_corr\u0027, FloatType(), True), # Correlation between right ascension and proper motion in right ascension\n    StructField(\u0027ra_pmdec_corr\u0027, FloatType(), True), # Correlation between right ascension and proper motion in declination\n    StructField(\u0027dec_parallax_corr\u0027, FloatType(), True), # Correlation between declination and parallax\n    StructField(\u0027dec_pmra_corr\u0027, FloatType(), True), # Correlation between declination and proper motion in right ascension\n    StructField(\u0027dec_pmdec_corr\u0027, FloatType(), True), # Correlation between declination and proper motion in declination\n    StructField(\u0027parallax_pmra_corr\u0027, FloatType(), True), # Correlation between parallax and proper motion in right ascension\n    StructField(\u0027parallax_pmdec_corr\u0027, FloatType(), True), # Correlation between parallax and proper motion in declination\n    StructField(\u0027pmra_pmdec_corr\u0027, FloatType(), True), # Correlation between proper motion in right ascension and proper motion in declination\n    StructField(\u0027astrometric_n_obs_al\u0027, ShortType(), True), # Total number of observations in the along-scan (AL) direction\n    StructField(\u0027astrometric_n_obs_ac\u0027, ShortType(), True), # Total number of observations in the across-scan (AC) direction\n    StructField(\u0027astrometric_n_good_obs_al\u0027, ShortType(), True), # Number of good observations in the along-scan (AL) direction\n    StructField(\u0027astrometric_n_bad_obs_al\u0027, ShortType(), True), # Number of bad observations in the along-scan (AL) direction\n    StructField(\u0027astrometric_gof_al\u0027, FloatType(), True), # Goodness of fit statistic of model wrt along-scan observations\n    StructField(\u0027astrometric_chi2_al\u0027, FloatType(), True), # AL chi-square value\n    StructField(\u0027astrometric_excess_noise\u0027, FloatType(), True), # Excess noise of the source\n    StructField(\u0027astrometric_excess_noise_sig\u0027, FloatType(), True), # Significance of excess noise\n    StructField(\u0027astrometric_params_solved\u0027, ByteType(), True), # Which parameters have been solved for?\n    StructField(\u0027astrometric_primary_flag\u0027, BooleanType(), True), # Primary or seconday\n    StructField(\u0027nu_eff_used_in_astrometry\u0027, FloatType(), True), # Effective wavenumber of the source used in the astrometric solution\n    StructField(\u0027pseudocolour\u0027, FloatType(), True), # Astrometrically estimated pseudocolour of the source\n    StructField(\u0027pseudocolour_error\u0027, FloatType(), True), # Standard error of the pseudocolour of the source\n    StructField(\u0027ra_pseudocolour_corr\u0027, FloatType(), True), # Correlation between right ascension and pseudocolour\n    StructField(\u0027dec_pseudocolour_corr\u0027, FloatType(), True), # Correlation between declination and pseudocolour\n    StructField(\u0027parallax_pseudocolour_corr\u0027, FloatType(), True), # Correlation between parallax and pseudocolour\n    StructField(\u0027pmra_pseudocolour_corr\u0027, FloatType(), True), # Correlation between proper motion in right asension and pseudocolour\n    StructField(\u0027pmdec_pseudocolour_corr\u0027, FloatType(), True), # Correlation between proper motion in declination and pseudocolour\n    StructField(\u0027astrometric_matched_transits\u0027, ShortType(), True), # Matched FOV transits used in the AGIS solution\n    StructField(\u0027visibility_periods_used\u0027, ShortType(), True), # Number of visibility periods used in Astrometric solution\n    StructField(\u0027astrometric_sigma5d_max\u0027, FloatType(), True), # The longest semi-major axis of the 5-d error ellipsoid\n    StructField(\u0027matched_transits\u0027, ShortType(), True), # The number of transits matched to this source\n    StructField(\u0027new_matched_transits\u0027, ShortType(), True), # The number of transits newly incorporated into an existing source in the current cycle\n    StructField(\u0027matched_transits_removed\u0027, ShortType(), True), # The number of transits removed from an existing source in the current cycle\n    StructField(\u0027ipd_gof_harmonic_amplitude\u0027, FloatType(), True), # Amplitude of the IPD GoF versus position angle of scan\n    StructField(\u0027ipd_gof_harmonic_phase\u0027, FloatType(), True), # Phase of the IPD GoF versus position angle of scan\n    StructField(\u0027ipd_frac_multi_peak\u0027, ByteType(), True), # Percent of successful-IPD windows with more than one peak\n    StructField(\u0027ipd_frac_odd_win\u0027, ByteType(), True), # Percent of transits with truncated windows or multiple gate\n    StructField(\u0027ruwe\u0027, FloatType(), True), # Renormalised unit weight error\n    StructField(\u0027scan_direction_strength_k1\u0027, FloatType(), True), # Degree of concentration of scan directions across the source\n    StructField(\u0027scan_direction_strength_k2\u0027, FloatType(), True), # Degree of concentration of scan directions across the source\n    StructField(\u0027scan_direction_strength_k3\u0027, FloatType(), True), # Degree of concentration of scan directions across the source\n    StructField(\u0027scan_direction_strength_k4\u0027, FloatType(), True), # Degree of concentration of scan directions across the source\n    StructField(\u0027scan_direction_mean_k1\u0027, FloatType(), True), # Mean position angle of scan directions across the source\n    StructField(\u0027scan_direction_mean_k2\u0027, FloatType(), True), # Mean position angle of scan directions across the source\n    StructField(\u0027scan_direction_mean_k3\u0027, FloatType(), True), # Mean position angle of scan directions across the source\n    StructField(\u0027scan_direction_mean_k4\u0027, FloatType(), True), # Mean position angle of scan directions across the source\n    StructField(\u0027duplicated_source\u0027, BooleanType(), True), # Source with multiple source identifiers\n    StructField(\u0027phot_g_n_obs\u0027, ShortType(), True), # Number of observations contributing to G photometry\n    StructField(\u0027phot_g_mean_flux\u0027, DoubleType(), True), # G-band mean flux\n    StructField(\u0027phot_g_mean_flux_error\u0027, FloatType(), True), # Error on G-band mean flux\n    StructField(\u0027phot_g_mean_flux_over_error\u0027, FloatType(), True), # G-band mean flux divided by its error\n    StructField(\u0027phot_g_mean_mag\u0027, FloatType(), True), # G-band mean magnitude\n    StructField(\u0027phot_bp_n_obs\u0027, ShortType(), True), # Number of observations contributing to BP photometry\n    StructField(\u0027phot_bp_mean_flux\u0027, DoubleType(), True), # Integrated BP mean flux\n    StructField(\u0027phot_bp_mean_flux_error\u0027, FloatType(), True), # Error on the integrated BP mean flux\n    StructField(\u0027phot_bp_mean_flux_over_error\u0027, FloatType(), True), # Integrated BP mean flux divided by its error\n    StructField(\u0027phot_bp_mean_mag\u0027, FloatType(), True), # Integrated BP mean magnitude\n    StructField(\u0027phot_rp_n_obs\u0027, ShortType(), True), # Number of observations contributing to RP photometry\n    StructField(\u0027phot_rp_mean_flux\u0027, DoubleType(), True), # Integrated RP mean flux\n    StructField(\u0027phot_rp_mean_flux_error\u0027, FloatType(), True), # Error on the integrated RP mean flux\n    StructField(\u0027phot_rp_mean_flux_over_error\u0027, FloatType(), True), # Integrated RP mean flux divided by its error\n    StructField(\u0027phot_rp_mean_mag\u0027, FloatType(), True), # Integrated RP mean magnitude\n    StructField(\u0027phot_bp_rp_excess_factor\u0027, FloatType(), True), # BP/RP excess factor\n    StructField(\u0027phot_bp_n_contaminated_transits\u0027, ShortType(), True), # Number of BP contaminated transits\n    StructField(\u0027phot_bp_n_blended_transits\u0027, ShortType(), True), # Number of BP blended transits\n    StructField(\u0027phot_rp_n_contaminated_transits\u0027, ShortType(), True), # Number of RP contaminated transits\n    StructField(\u0027phot_rp_n_blended_transits\u0027, ShortType(), True), # Number of RP blended transits\n    StructField(\u0027phot_proc_mode\u0027, ByteType(), True), # Photometry processing mode\n    StructField(\u0027bp_rp\u0027, FloatType(), True), # BP - RP colour\n    StructField(\u0027bp_g\u0027, FloatType(), True), # BP - G colour\n    StructField(\u0027g_rp\u0027, FloatType(), True), # G - RP colour\n    StructField(\u0027radial_velocity\u0027, FloatType(), True), # Radial velocity \n    StructField(\u0027radial_velocity_error\u0027, FloatType(), True), # Radial velocity error \n    StructField(\u0027rv_method_used\u0027, ByteType(), True), # Method used to obtain the radial velocity\n    StructField(\u0027rv_nb_transits\u0027, ShortType(), True), # Number of transits used to compute the radial velocity \n    StructField(\u0027rv_nb_deblended_transits\u0027, ShortType(), True), # Number of valid transits that have undergone deblending\n    StructField(\u0027rv_visibility_periods_used\u0027, ShortType(), True), # Number of visibility periods used to estimate the radial velocity\n    StructField(\u0027rv_expected_sig_to_noise\u0027, FloatType(), True), # Expected signal to noise ratio in the combination of the spectra used to obtain the radial velocity\n    StructField(\u0027rv_renormalised_gof\u0027, FloatType(), True), # Radial velocity renormalised goodness of fit\n    StructField(\u0027rv_chisq_pvalue\u0027, FloatType(), True), # P-value for constancy based on a chi-squared criterion\n    StructField(\u0027rv_time_duration\u0027, FloatType(), True), # Time coverage of the radial velocity time series\n    StructField(\u0027rv_amplitude_robust\u0027, FloatType(), True), # Total amplitude in the radial velocity time series after outlier removal\n    StructField(\u0027rv_template_teff\u0027, FloatType(), True), # Teff of the template used to compute the radial velocity \n    StructField(\u0027rv_template_logg\u0027, FloatType(), True), # Logg of the template used to compute the radial velocity \n    StructField(\u0027rv_template_fe_h\u0027, FloatType(), True), # [Fe/H] of the template used to compute the radial velocityy\n    StructField(\u0027rv_atm_param_origin\u0027, ShortType(), True), # Origin of the atmospheric parameters associated to the template\n    StructField(\u0027vbroad\u0027, FloatType(), True), # Spectral line broadening parameter\n    StructField(\u0027vbroad_error\u0027, FloatType(), True), # Uncertainty on the spectral line broadening\n    StructField(\u0027vbroad_nb_transits\u0027, ShortType(), True), # Number of transits used to compute vbroad\n    StructField(\u0027grvs_mag\u0027, FloatType(), True), # Integrated Grvs magnitude\n    StructField(\u0027grvs_mag_error\u0027, FloatType(), True), # Grvs magnitude uncertainty\n    StructField(\u0027grvs_mag_nb_transits\u0027, ShortType(), True), # Number of transits used to compute Grvs\n    StructField(\u0027rvs_spec_sig_to_noise\u0027, FloatType(), True), # Signal to noise ratio in the mean RVS spectrum\n    StructField(\u0027phot_variable_flag\u0027, StringType(), True), # Photometric variability flag\n    StructField(\u0027l\u0027, DoubleType(), True), # Galactic longitude\n    StructField(\u0027b\u0027, DoubleType(), True), # Galactic latitude\n    StructField(\u0027ecl_lon\u0027, DoubleType(), True), # Ecliptic longitude\n    StructField(\u0027ecl_lat\u0027, DoubleType(), True), # Ecliptic latitude\n    StructField(\u0027in_qso_candidates\u0027, BooleanType(), True), # Flag indicating the availability of additional information in the QsoCandidates table\n    StructField(\u0027in_galaxy_candidates\u0027, BooleanType(), True), # Flag indicating the availability of additional information in the GalaxyCandidates table\n    StructField(\u0027non_single_star\u0027, ShortType(), True), # Flag indicating the availability of additional information in the various Non-Single Star tables\n    StructField(\u0027has_xp_continuous\u0027, BooleanType(), True), # Flag indicating the availability of mean BP/RP spectrum in continuous representation for this source\n    StructField(\u0027has_xp_sampled\u0027, BooleanType(), True), # Flag indicating the availability of mean BP/RP spectrum in sampled form for this source\n    StructField(\u0027has_rvs\u0027, BooleanType(), True), # Flag indicating the availability of mean RVS spectrum for this source\n    StructField(\u0027has_epoch_photometry\u0027, BooleanType(), True), # Flag indicating the availability of epoch photometry for this source\n    StructField(\u0027has_epoch_rv\u0027, BooleanType(), True), # Flag indicating the availability of epoch radial velocity for this source\n    StructField(\u0027has_mcmc_gspphot\u0027, BooleanType(), True), # Flag indicating the availability of GSP-Phot MCMC samples for this source\n    StructField(\u0027has_mcmc_msc\u0027, BooleanType(), True), # Flag indicating the availability of MSC MCMC samples for this source\n    StructField(\u0027in_andromeda_survey\u0027, BooleanType(), True), # Flag indicating that the source is present in the Gaia Andromeda Photometric Survey (GAPS)\n    StructField(\u0027classprob_dsc_combmod_quasar\u0027, FloatType(), True), # Probability from DSC-Combmod of being a quasar (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_galaxy\u0027, FloatType(), True), # Probability from DSC-Combmod of being a galaxy (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_star\u0027, FloatType(), True), # Probability from DSC-Combmod of being a single star (but not a white dwarf) (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027teff_gspphot\u0027, FloatType(), True), # Effective temperature from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027teff_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of effective temperature from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027teff_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of effective temperature from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logg_gspphot\u0027, FloatType(), True), # Surface gravity from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logg_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of surface gravity from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027logg_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of surface gravity from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mh_gspphot\u0027, FloatType(), True), # Iron abundance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mh_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of iron abundance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027mh_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of iron abundance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027distance_gspphot\u0027, FloatType(), True), # Distance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027distance_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of distance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027distance_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of distance from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027azero_gspphot\u0027, FloatType(), True), # Monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027azero_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027azero_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of monochromatic extinction $A_0$ at 547.7nm from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ag_gspphot\u0027, FloatType(), True), # Extinction in G band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ag_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of extinction in G band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ag_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of extinction in G band from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot\u0027, FloatType(), True), # Reddening $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_lower\u0027, FloatType(), True), # Lower confidence level (16%) of reddening  $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027ebpminrp_gspphot_upper\u0027, FloatType(), True), # Upper confidence level (84%) of reddening  $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot Aeneas best library using BP/RP spectra\n    StructField(\u0027libname_gspphot\u0027, StringType(), True), # Name of library that achieves the highest mean log-posterior in MCMC samples and was used to derive GSP-Phot parameters in this table\n])\ngalaxy_candidates_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027vari_best_class_name\u0027, StringType(), True), # Name of best class, see table VariClassifierClassDefinition for details of the class\n    StructField(\u0027vari_best_class_score\u0027, FloatType(), True), # Score of the best class\n    StructField(\u0027classprob_dsc_combmod_galaxy\u0027, FloatType(), True), # Probability from DSC-Combmod of being a galaxy (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_quasar\u0027, FloatType(), True), # Probability from DSC-Combmod of being a quasar (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classlabel_dsc\u0027, StringType(), True), # Class assigned by DSC based on the probability from its Combmod classifier\n    StructField(\u0027classlabel_dsc_joint\u0027, StringType(), True), # Class assigned by DSC based on the probability from its Specmod and Allosmod classifiers\n    StructField(\u0027classlabel_oa\u0027, StringType(), True), # Class assigned by OA the neuron that represents the source\n    StructField(\u0027redshift_ugc\u0027, FloatType(), True), # Redshift from UGC\n    StructField(\u0027redshift_ugc_lower\u0027, FloatType(), True), # Redshift prediction lower limit from UGC\n    StructField(\u0027redshift_ugc_upper\u0027, FloatType(), True), # Redshift prediction upper limit from UGC\n    StructField(\u0027n_transits\u0027, IntegerType(), True), # Number of transits used for the morphological analysis\n    StructField(\u0027posangle_sersic\u0027, DoubleType(), True), # Fitted position angle of the source for the Sersic Profile\n    StructField(\u0027posangle_sersic_error\u0027, DoubleType(), True), # Error on the fitted position angle of the source for the Sersic Profile\n    StructField(\u0027intensity_sersic\u0027, DoubleType(), True), # Fitted intensity of the source for the Sersic Profile\n    StructField(\u0027intensity_sersic_error\u0027, DoubleType(), True), # Error on the fitted intensity of the source at effective radius radiusSersic\n    StructField(\u0027radius_sersic\u0027, DoubleType(), True), # Fitted effective radius of the source for the Sersic Profile\n    StructField(\u0027radius_sersic_error\u0027, DoubleType(), True), # Error on the fitted effective radius of the source for the Sersic Profile\n    StructField(\u0027ellipticity_sersic\u0027, DoubleType(), True), # Fitted ellipticity of source for the Sersic Profile\n    StructField(\u0027ellipticity_sersic_error\u0027, DoubleType(), True), # Error on the fitted ellipticity of the source for the Sersic Profile\n    StructField(\u0027n_sersic\u0027, FloatType(), True), # Fitted Sersic Index for Sersic Profile\n    StructField(\u0027n_sersic_error\u0027, FloatType(), True), # Error on the fitted Sersic Index for Sersic Profile\n    StructField(\u0027l2_sersic\u0027, DoubleType(), True), # L2 norm for the Sersic Profile\n    StructField(\u0027morph_params_corr_vec_sersic\u0027, ArrayType(DoubleType()), True), # Vector form of the upper triangle of the correlation matrix for the fitted parameters for the Sersic Profile\n    StructField(\u0027flags_sersic\u0027, ByteType(), True), # Flag indicative of processing or scientific quality for the morphological parameters fitting for the Sersic Profile\n    StructField(\u0027posangle_de_vaucouleurs\u0027, DoubleType(), True), # Fitted position angle of the source for the de Vaucouleurs Profile\n    StructField(\u0027posangle_de_vaucouleurs_error\u0027, DoubleType(), True), # Error on the fitted position angle of the source for the de Vaucouleurs Profile\n    StructField(\u0027intensity_de_vaucouleurs\u0027, DoubleType(), True), # Fitted intensity of the source for the de Vaucouleurs Profile\n    StructField(\u0027intensity_de_vaucouleurs_error\u0027, DoubleType(), True), # Error on the fitted intensity of the bulge for the de Vaucouleurs Profile\n    StructField(\u0027radius_de_vaucouleurs\u0027, DoubleType(), True), # Fitted effective radius of the source for de Vaucouleurs Profile\n    StructField(\u0027radius_de_vaucouleurs_error\u0027, DoubleType(), True), # Error on the fitted effective radius of the source for the de Vaucouleurs Profile\n    StructField(\u0027ellipticity_de_vaucouleurs\u0027, DoubleType(), True), # Fitted ellipticity of source for the de Vaucouleurs Profile\n    StructField(\u0027ellipticity_de_vaucouleurs_error\u0027, DoubleType(), True), # Error on the fitted ellipticity of the source for the de Vaucouleurs Profile\n    StructField(\u0027l2_de_vaucouleurs\u0027, DoubleType(), True), # L2 norm for the de Vaucouleurs Profile\n    StructField(\u0027morph_params_corr_vec_de_vaucouleurs\u0027, ArrayType(DoubleType()), True), # Vector form of the upper triangle of the correlation matrix for the fitted parameters for the de Vaucouleurs Profile\n    StructField(\u0027flags_de_vaucouleurs\u0027, ByteType(), True), # Flag indicative of processing or scientific quality for the morphological parameters fitting for the de Vaucouleurs Profile\n    StructField(\u0027source_selection_flags\u0027, IntegerType(), True), # Bit indicative of whether the input data from a given module met the source list eligibility criteria for the source of interest\n])\ngalaxy_catalogue_name_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027catalogue_id\u0027, ByteType(), False), # The unique identifier for the catalogue(s) used to select the sources in the morphological analysis\n])\nmcmc_samples_gsp_phot_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027nsamples\u0027, ShortType(), True), # Number of samples in the chain from GSP-Phot\n    StructField(\u0027teff\u0027, ArrayType(FloatType()), True), # MCMC samples for $T_{\\rm eff}$ from GSP-Phot\n    StructField(\u0027azero\u0027, ArrayType(FloatType()), True), # MCMC samples for extinction $A_0$ from GSP-Phot\n    StructField(\u0027logg\u0027, ArrayType(FloatType()), True), # MCMC samples for $\\log g$ from GSP-Phot\n    StructField(\u0027mh\u0027, ArrayType(FloatType()), True), # MCMC samples for the metallicity from GSP-Phot\n    StructField(\u0027ag\u0027, ArrayType(FloatType()), True), # MCMC samples for extinction in G band from GSP-Phot\n    StructField(\u0027mg\u0027, ArrayType(FloatType()), True), # MCMC samples for $M_{\\rm G}$ from GSP-Phot\n    StructField(\u0027distancepc\u0027, ArrayType(FloatType()), True), # MCMC samples for distance from GSP-Phot\n    StructField(\u0027abp\u0027, ArrayType(FloatType()), True), # MCMC samples for extinction in $G_{\\rm BP}$ band from GSP-Phot\n    StructField(\u0027arp\u0027, ArrayType(FloatType()), True), # MCMC samples for extinction in $G_{\\rm RP}$ band from GSP-Phot\n    StructField(\u0027ebpminrp\u0027, ArrayType(FloatType()), True), # MCMC samples for reddening $E(G_{\\rm BP} - G_{\\rm RP})$ from GSP-Phot\n    StructField(\u0027log_pos\u0027, ArrayType(FloatType()), True), # MCMC samples for the log-posterior from GSP-Phot\n    StructField(\u0027log_lik\u0027, ArrayType(FloatType()), True), # MCMC samples for the log-likelihood from GSP-Phot\n    StructField(\u0027radius\u0027, ArrayType(FloatType()), True), # MCMC samples for stellar radius from GSP-Phot\n])\nmcmc_samples_msc_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027nsamples\u0027, ShortType(), True), # Number of samples in the chain from MSC\n    StructField(\u0027teff1\u0027, ArrayType(FloatType()), True), # MCMC samples for $T_{\\rm eff, 1}$ of primary from MSC\n    StructField(\u0027teff2\u0027, ArrayType(FloatType()), True), # MCMC samples for $T_{\\rm eff, 2}$ of secondary from MSC\n    StructField(\u0027logg1\u0027, ArrayType(FloatType()), True), # MCMC samples for $\\log g_1$ of primary from MSC\n    StructField(\u0027logg2\u0027, ArrayType(FloatType()), True), # MCMC samples for $\\log g_2$ of secondary from MSC\n    StructField(\u0027azero\u0027, ArrayType(FloatType()), True), # MCMC samples for extinction $A_0$ from MSC\n    StructField(\u0027mh\u0027, ArrayType(FloatType()), True), # MCMC samples for the metallicity from MSC\n    StructField(\u0027distancepc\u0027, ArrayType(FloatType()), True), # MCMC samples for distance from MSC\n    StructField(\u0027log_pos\u0027, ArrayType(FloatType()), True), # MCMC samples for the log-posterior from MSC\n    StructField(\u0027log_lik\u0027, ArrayType(FloatType()), True), # MCMC samples for the log-likelihood from MSC\n])\nnss_acceleration_astro_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source Identifier\n    StructField(\u0027nss_solution_type\u0027, StringType(), True), # NSS model adopted\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right ascension\n    StructField(\u0027ra_error\u0027, FloatType(), True), # Standard error of right ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027dec_error\u0027, FloatType(), True), # Standard error of declination\n    StructField(\u0027parallax\u0027, DoubleType(), True), # Parallax\n    StructField(\u0027parallax_error\u0027, FloatType(), True), # Standard error of parallax\n    StructField(\u0027pmra\u0027, DoubleType(), True), # Proper motion in right ascension direction\n    StructField(\u0027pmra_error\u0027, FloatType(), True), # Standard error of proper motion in right ascension direction\n    StructField(\u0027pmdec\u0027, DoubleType(), True), # Proper motion in declination direction\n    StructField(\u0027pmdec_error\u0027, FloatType(), True), # Standard error of proper motion in declination direction\n    StructField(\u0027accel_ra\u0027, DoubleType(), True), # Acceleration in RA\n    StructField(\u0027accel_ra_error\u0027, FloatType(), True), # Standard error of Acceleration in RA\n    StructField(\u0027accel_dec\u0027, DoubleType(), True), # Acceleration in DEC\n    StructField(\u0027accel_dec_error\u0027, FloatType(), True), # Standard error of Acceleration in DEC\n    StructField(\u0027deriv_accel_ra\u0027, DoubleType(), True), # Time derivative of the accel. in RA\n    StructField(\u0027deriv_accel_ra_error\u0027, FloatType(), True), # Standard error of Time derivative of the acceleration in RA\n    StructField(\u0027deriv_accel_dec\u0027, DoubleType(), True), # Time derivative of the accel. in DEC\n    StructField(\u0027deriv_accel_dec_error\u0027, FloatType(), True), # Standard error of Time derivative of the acceleration in DEC\n    StructField(\u0027astrometric_n_obs_al\u0027, IntegerType(), True), # Total astrometric CCD observations in AL considered\n    StructField(\u0027astrometric_n_good_obs_al\u0027, IntegerType(), True), # Total astrometric CCD observations in AL actually used\n    StructField(\u0027bit_index\u0027, LongType(), True), # Boolean mask for the fields above in the corrVec matrix \n    StructField(\u0027corr_vec\u0027, ArrayType(FloatType()), True), # Vector form of the upper triangle of the correlation matrix\n    StructField(\u0027obj_func\u0027, FloatType(), True), # Value of the objective function at the solution\n    StructField(\u0027goodness_of_fit\u0027, FloatType(), True), # Goodness of fit in the Hipparcos sense\n    StructField(\u0027significance\u0027, FloatType(), True), # The significance of the solution (i.e. how worth keeping a model is)\n    StructField(\u0027flags\u0027, LongType(), True), # Quality flag for the achieved NSS solution\n])\nnss_non_linear_spectro_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source Identifier\n    StructField(\u0027nss_solution_type\u0027, StringType(), True), # NSS model adopted\n    StructField(\u0027mean_velocity\u0027, DoubleType(), True), # Mean velocity\n    StructField(\u0027mean_velocity_error\u0027, FloatType(), True), # Standard error of Mean velocity\n    StructField(\u0027first_deriv_velocity\u0027, DoubleType(), True), # First order derivative of the velocity\n    StructField(\u0027first_deriv_velocity_error\u0027, FloatType(), True), # Standard error of First order derivative of the velocity\n    StructField(\u0027second_deriv_velocity\u0027, DoubleType(), True), # Second order derivative of the velocity\n    StructField(\u0027second_deriv_velocity_error\u0027, FloatType(), True), # Standard error of Second order derivative of the velocity\n    StructField(\u0027rv_n_obs_primary\u0027, IntegerType(), True), # Total number of radial velocities considered for the primary\n    StructField(\u0027rv_n_good_obs_primary\u0027, IntegerType(), True), # Total number of radial velocities actually used for the primary\n    StructField(\u0027bit_index\u0027, LongType(), True), # Boolean mask for the fields above in the corrVec matrix \n    StructField(\u0027corr_vec\u0027, ArrayType(FloatType()), True), # Vector form of the upper triangle of the correlation matrix\n    StructField(\u0027obj_func\u0027, FloatType(), True), # Value of the objective function at the solution\n    StructField(\u0027goodness_of_fit\u0027, FloatType(), True), # Goodness of fit in the Hipparcos sense\n    StructField(\u0027flags\u0027, LongType(), True), # Quality flag for the achieved NSS solution\n])\nnss_two_body_orbit_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source Identifier\n    StructField(\u0027nss_solution_type\u0027, StringType(), False), # NSS model adopted\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right ascension\n    StructField(\u0027ra_error\u0027, FloatType(), True), # Standard error of right ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027dec_error\u0027, FloatType(), True), # Standard error of declination\n    StructField(\u0027parallax\u0027, DoubleType(), True), # Parallax\n    StructField(\u0027parallax_error\u0027, FloatType(), True), # Standard error of parallax\n    StructField(\u0027pmra\u0027, DoubleType(), True), # Proper motion in right ascension direction\n    StructField(\u0027pmra_error\u0027, FloatType(), True), # Standard error of proper motion in right ascension direction\n    StructField(\u0027pmdec\u0027, DoubleType(), True), # Proper motion in declination direction\n    StructField(\u0027pmdec_error\u0027, FloatType(), True), # Standard error of proper motion in declination direction\n    StructField(\u0027a_thiele_innes\u0027, DoubleType(), True), # Thiele-Innes element A\n    StructField(\u0027a_thiele_innes_error\u0027, FloatType(), True), # Standard error of Thiele-Innes element A\n    StructField(\u0027b_thiele_innes\u0027, DoubleType(), True), # Thiele-Innes element B\n    StructField(\u0027b_thiele_innes_error\u0027, FloatType(), True), # Standard error of Thiele-Innes element B\n    StructField(\u0027f_thiele_innes\u0027, DoubleType(), True), # Thiele-Innes element F\n    StructField(\u0027f_thiele_innes_error\u0027, FloatType(), True), # Standard error of Thiele-Innes element F\n    StructField(\u0027g_thiele_innes\u0027, DoubleType(), True), # Thiele-Innes element G\n    StructField(\u0027g_thiele_innes_error\u0027, FloatType(), True), # Standard error of Thiele-Innes element G\n    StructField(\u0027c_thiele_innes\u0027, DoubleType(), True), # C element of Thiele-Innes \n    StructField(\u0027c_thiele_innes_error\u0027, FloatType(), True), # Standard error of C element of Thiele-Innes \n    StructField(\u0027h_thiele_innes\u0027, DoubleType(), True), # H element of Thiele-Innes \n    StructField(\u0027h_thiele_innes_error\u0027, FloatType(), True), # Standard error of H element of Thiele-Innes \n    StructField(\u0027period\u0027, DoubleType(), True), # Orbital Period\n    StructField(\u0027period_error\u0027, FloatType(), True), # Standard error of Orbital Period\n    StructField(\u0027t_periastron\u0027, DoubleType(), True), # Periastron epoch\n    StructField(\u0027t_periastron_error\u0027, FloatType(), True), # Standard error of Periastron epoch\n    StructField(\u0027eccentricity\u0027, DoubleType(), True), # eccentricity\n    StructField(\u0027eccentricity_error\u0027, FloatType(), True), # Standard error of eccentricity\n    StructField(\u0027center_of_mass_velocity\u0027, DoubleType(), True), # The velocity of the center of mass\n    StructField(\u0027center_of_mass_velocity_error\u0027, FloatType(), True), # Standard error of The velocity of the center of mass\n    StructField(\u0027semi_amplitude_primary\u0027, DoubleType(), True), # Semi-amplitude of the center of mass\n    StructField(\u0027semi_amplitude_primary_error\u0027, FloatType(), True), # Standard error of Semi-amplitude of the center of mass\n    StructField(\u0027semi_amplitude_secondary\u0027, DoubleType(), True), # The semiamplitude of the radial velocity curve for second component\n    StructField(\u0027semi_amplitude_secondary_error\u0027, FloatType(), True), # Standard error of The semiamplitude of the radial velocity curve for second component\n    StructField(\u0027mass_ratio\u0027, DoubleType(), True), # Mass ratio\n    StructField(\u0027mass_ratio_error\u0027, FloatType(), True), # Standard error of Mass ratio\n    StructField(\u0027fill_factor_primary\u0027, DoubleType(), True), # Fill factor of primary\n    StructField(\u0027fill_factor_primary_error\u0027, FloatType(), True), # Standard error of Fill factor of primary\n    StructField(\u0027fill_factor_secondary\u0027, DoubleType(), True), # Fill factor of secondary\n    StructField(\u0027fill_factor_secondary_error\u0027, FloatType(), True), # Standard error of Fill factor of secondary\n    StructField(\u0027inclination\u0027, DoubleType(), True), # Orbital inclination\n    StructField(\u0027inclination_error\u0027, FloatType(), True), # Standard error of Orbital inclination\n    StructField(\u0027arg_periastron\u0027, DoubleType(), True), # Argument of periastron\n    StructField(\u0027arg_periastron_error\u0027, FloatType(), True), # Standard error of Argument of periastron\n    StructField(\u0027temperature_ratio\u0027, DoubleType(), True), # Ratio of the effective temperatures\n    StructField(\u0027temperature_ratio_error\u0027, DoubleType(), True), # Standard error of the ratio of the effective temperatures\n    StructField(\u0027temperature_ratio_definition\u0027, ByteType(), True), # Code defining which fitting scenario did apply to the effective temperature\n    StructField(\u0027astrometric_n_obs_al\u0027, IntegerType(), True), # Total astrometric CCD observations in AL considered\n    StructField(\u0027astrometric_n_good_obs_al\u0027, IntegerType(), True), # Total astrometric CCD observations in AL actually used\n    StructField(\u0027rv_n_obs_primary\u0027, IntegerType(), True), # Total number of radial velocities considered for the primary\n    StructField(\u0027rv_n_good_obs_primary\u0027, IntegerType(), True), # Total number of radial velocities actually used for the primary\n    StructField(\u0027rv_n_obs_secondary\u0027, IntegerType(), True), # Total number of radial velocities considered for the secondary in the case of SB2\n    StructField(\u0027rv_n_good_obs_secondary\u0027, IntegerType(), True), # Total number of radial velocities actually used for the secondary in the case of SB2\n    StructField(\u0027phot_g_n_obs\u0027, IntegerType(), True), # Total number of G photometry measurements considered\n    StructField(\u0027phot_g_n_good_obs\u0027, IntegerType(), True), # Total number of G photometry measurements actually used\n    StructField(\u0027bit_index\u0027, LongType(), True), # boolean mask for the fields above in the corrVec matrix \n    StructField(\u0027corr_vec\u0027, ArrayType(FloatType()), True), # Vector form of the upper triangle of the correlation matrix (column-major ordered)\n    StructField(\u0027obj_func\u0027, FloatType(), True), # value of the objective function at the solution\n    StructField(\u0027goodness_of_fit\u0027, FloatType(), True), # goodness of fit in the Hipparcos sense\n    StructField(\u0027efficiency\u0027, FloatType(), True), # Efficiency of the solution\n    StructField(\u0027significance\u0027, FloatType(), True), # The significance of the solution (i.e. how worth keeping a model is)\n    StructField(\u0027flags\u0027, LongType(), True), # Quality flag for the achieved NSS solution\n    StructField(\u0027conf_spectro_period\u0027, FloatType(), True), # The probability of the period for not being due to (gaussian white) noise. Relevant for SB1, SB1C, SB2 and SB2C models. To be ignored otherwise.\n    StructField(\u0027r_pole_sum\u0027, DoubleType(), True), # Sum of the polar radii of primary and secondary (in units of the semi-major axis)\n    StructField(\u0027r_l1_point_sum\u0027, DoubleType(), True), # L1-pointing radii of primary and secondary (in units of the semi-major axis)\n    StructField(\u0027r_spher_sum\u0027, DoubleType(), True), # Sum of the radii of sphere having the same volume as the primary and secondary (in units of the semi-major axis\n    StructField(\u0027ecl_time_primary\u0027, DoubleType(), True), # Time of mid-eclipse of the primary by the secondary\n    StructField(\u0027ecl_time_secondary\u0027, DoubleType(), True), # Time of mid-eclipse of the secondary by the primary\n    StructField(\u0027ecl_dur_primary\u0027, DoubleType(), True), # Duration of primary eclipse assuming spherical components\n    StructField(\u0027ecl_dur_secondary\u0027, DoubleType(), True), # Duration of secondary eclipse assuming spherical components\n    StructField(\u0027g_luminosity_ratio\u0027, DoubleType(), True), # Ratio of the G-band luminosity of the secondary over the primary\n    StructField(\u0027input_period_error\u0027, FloatType(), True), # Standard error of the period taken from VariEclipsingBinary.frequencyError\n    StructField(\u0027g_rank\u0027, DoubleType(), True), # Rank of the G-band solution\n    StructField(\u0027astrometric_jitter\u0027, DoubleType(), True), # Uncorrelated astrometric jitter term\n])\nnss_vim_fl_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source Identifier\n    StructField(\u0027nss_solution_type\u0027, StringType(), True), # NSS model adopted\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right ascension\n    StructField(\u0027ra_error\u0027, FloatType(), True), # Standard error of right ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027dec_error\u0027, FloatType(), True), # Standard error of declination\n    StructField(\u0027parallax\u0027, DoubleType(), True), # Parallax\n    StructField(\u0027parallax_error\u0027, FloatType(), True), # Standard error of parallax\n    StructField(\u0027pmra\u0027, DoubleType(), True), # Proper motion in right ascension direction\n    StructField(\u0027pmra_error\u0027, FloatType(), True), # Standard error of proper motion in right ascension direction\n    StructField(\u0027pmdec\u0027, DoubleType(), True), # Proper motion in declination direction\n    StructField(\u0027pmdec_error\u0027, FloatType(), True), # Standard error of proper motion in declination direction\n    StructField(\u0027ref_flux_g\u0027, FloatType(), True), # Reference flux in the G band\n    StructField(\u0027vim_d_ra\u0027, DoubleType(), True), # VIM coordinate in RA\n    StructField(\u0027vim_d_ra_error\u0027, FloatType(), True), # Standard error of VIM coordinate in RA\n    StructField(\u0027vim_d_dec\u0027, DoubleType(), True), # VIM coordinate in DEC\n    StructField(\u0027vim_d_dec_error\u0027, FloatType(), True), # Standard error of VIM coordinate in DEC\n    StructField(\u0027astrometric_n_obs_al\u0027, IntegerType(), True), # Total astrometric CCD observations in AL considered\n    StructField(\u0027astrometric_n_good_obs_al\u0027, IntegerType(), True), # Total astrometric CCD observations in AL actually used\n    StructField(\u0027bit_index\u0027, LongType(), True), # Boolean mask for the fields above in the corrVec matrix \n    StructField(\u0027corr_vec\u0027, ArrayType(FloatType()), True), # Vector form of the upper triangle of the correlation matrix\n    StructField(\u0027obj_func\u0027, FloatType(), True), # Value of the objective function at the solution\n    StructField(\u0027goodness_of_fit\u0027, FloatType(), True), # Goodness of fit in the Hipparcos sense\n    StructField(\u0027efficiency\u0027, FloatType(), True), # Efficiency of the solution\n    StructField(\u0027significance\u0027, FloatType(), True), # The significance of the solution (i.e. how worth keeping a model is)\n    StructField(\u0027flags\u0027, LongType(), True), # Quality flag for the achieved NSS solution\n])\noa_neuron_information_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027som_id\u0027, LongType(), False), # Self-Organized Map identifier\n    StructField(\u0027neuron_id\u0027, LongType(), False), # Neuron identifier\n    StructField(\u0027neuron_row_index\u0027, ShortType(), True), # Row index of the neuron in the Self-Organised Map lattice\n    StructField(\u0027neuron_column_index\u0027, ShortType(), True), # Column index of the neuron in the Self-Organised Map lattice\n    StructField(\u0027hits\u0027, IntegerType(), True), # Number of sources populating the neuron\n    StructField(\u0027class_label\u0027, StringType(), True), # Astronomical class estimated for the neuron\n    StructField(\u0027centroid_id\u0027, LongType(), True), # Identifier of the Gaia source that minimizes the classification distance to the neuron\n    StructField(\u0027centroid_distance\u0027, FloatType(), True), # Squared Euclidean distance between the centroid XP spectrum and the neuron XP prototype\n    StructField(\u0027template_distance\u0027, FloatType(), True), # Squared Euclidean distance between the reference XP template and the neuron XP prototype\n    StructField(\u0027g_mag_mean\u0027, FloatType(), True), # Mean $G$ value for the sources that belong to the neuron\n    StructField(\u0027g_mag_std_dev\u0027, FloatType(), True), # Standard deviation of $G$ values for the sources that belong to the neuron\n    StructField(\u0027g_mag_min\u0027, FloatType(), True), # Minimum $G$ value for the sources that belong to the neuron\n    StructField(\u0027g_mag_max\u0027, FloatType(), True), # Maximum $G$ value for the sources that belong to the neuron\n    StructField(\u0027bp_mag_mean\u0027, FloatType(), True), # Mean $G_{\\rm BP}$ value for the sources that belong to the neuron\n    StructField(\u0027bp_mag_std_dev\u0027, FloatType(), True), # Standard deviation of $G_{\\rm BP}$ values for the sources that belong to the neuron \n    StructField(\u0027bp_mag_min\u0027, FloatType(), True), # Minimum value of $G_{\\rm BP}$ for the sources that belong to the neuron \n    StructField(\u0027bp_mag_max\u0027, FloatType(), True), # Maximum value of $G_{\\rm BP}$ for the sources that belong to the neuron \n    StructField(\u0027rp_mag_mean\u0027, FloatType(), True), # Mean $G_{\\rm RP}$ value for the sources that belong to the neuron neuron\n    StructField(\u0027rp_mag_std_dev\u0027, FloatType(), True), # Standard deviation of $G_{\\rm RP}$ values for the sources that belong to the neuron\n    StructField(\u0027rp_mag_min\u0027, FloatType(), True), # Minimum value of $G_{\\rm RP}$ for the sources that belong to the neuron  \n    StructField(\u0027rp_mag_max\u0027, FloatType(), True), # Maximum value of $G_{\\rm RP}$ for the sources that belong to the neuron\n    StructField(\u0027pm_ra_mean\u0027, FloatType(), True), # Mean value of the proper motion in right ascension for the sources that belong to the neuron\n    StructField(\u0027pm_ra_std_dev\u0027, FloatType(), True), # Standard deviation of the proper motion in right ascension for the sources that belong to the neuron\n    StructField(\u0027pm_ra_min\u0027, FloatType(), True), # Minimum value of the proper motion in right ascension for the sources that belong to the neuron\n    StructField(\u0027pm_ra_max\u0027, FloatType(), True), # Maximum value of the proper motion in right ascension for the sources that belong to the neuron\n    StructField(\u0027pm_dec_mean\u0027, FloatType(), True), # Mean value of the proper motion in declination for the sources that belong to the neuron\n    StructField(\u0027pm_dec_std_dev\u0027, FloatType(), True), # Standard deviation of the proper motion in declination for the sources that belong to the neuron\n    StructField(\u0027pm_dec_min\u0027, FloatType(), True), # Minimum value of the proper motion in declination for the sources that belong to the neuron\n    StructField(\u0027pm_dec_max\u0027, FloatType(), True), # Maximum value of the proper motion in declination for the sources that belong to the neuron\n    StructField(\u0027parallax_mean\u0027, FloatType(), True), # Mean parallax value for the sources that belong to the neuron\n    StructField(\u0027parallax_std_dev\u0027, FloatType(), True), # Standard deviation of the parallax values for the sources that belong to the neuron\n    StructField(\u0027parallax_min\u0027, FloatType(), True), # Minimum parallax value for the sources that belong to the neuron \n    StructField(\u0027parallax_max\u0027, FloatType(), True), # Maximum parallax value for the sources that belong to the neuron\n    StructField(\u0027gal_latitude_mean\u0027, FloatType(), True), # Mean galactic latitude for the sources that belong to the neuron\n    StructField(\u0027gal_latitude_std_dev\u0027, FloatType(), True), # Standard deviation of the galactic latitude values for the sources that belong to the neuron \n    StructField(\u0027gal_latitude_min\u0027, FloatType(), True), # Minimum galactic latitude for the sources that belong to the neuron\n    StructField(\u0027gal_latitude_max\u0027, FloatType(), True), # Maximum galactic latitude for the sources that belong to the neuron\n    StructField(\u0027intra_neuron_distance_mean\u0027, FloatType(), True), # Mean value of the squared Euclidean distance between each of the XP sources in the neuron and the neuron prototype\n    StructField(\u0027intra_neuron_distance_std_dev\u0027, FloatType(), True), # Standard deviation of the squared Euclidean distance between each of the XP sources in the neuron and the neuron prototype\n    StructField(\u0027intra_neuron_distance_min\u0027, FloatType(), True), # Minimum squared Euclidean distance between each of the XP sources in the neuron and the neuron prototype\n    StructField(\u0027intra_neuron_distance_max\u0027, FloatType(), True), # Maximum squared Euclidean distance between each of the XP sources in the neuron and the neuron prototype\n    StructField(\u0027inter_neuron_distance_mean\u0027, FloatType(), True), # Mean value of the squared Euclidean distance between the neuron XP prototype and the XP prototypes of its immediate neighbours\n    StructField(\u0027inter_neuron_distance_std_dev\u0027, FloatType(), True), # Standard deviation of the squared Euclidean distance between the neuron XP prototype and the XP prototypes of its immediate neighbours\n    StructField(\u0027inter_neuron_distance_min\u0027, FloatType(), True), # Minimum value of the squared Euclidean distance between the neuron XP prototype and the XP prototypes of its immediate neighbours\n    StructField(\u0027inter_neuron_distance_max\u0027, FloatType(), True), # Maximum value of the squared Euclidean distance between the neuron XP prototype and the XP prototypes of its immediate neighbours\n    StructField(\u0027template_name\u0027, StringType(), True), # Name of the template used to describe the neuron\n    StructField(\u0027distance_percentile25\u0027, FloatType(), True), # 25th percentile value for the intra-neuron distance distribution\n    StructField(\u0027distance_percentile50\u0027, FloatType(), True), # 50th percentile value for the intra-neuron distance distribution \n    StructField(\u0027distance_percentile68\u0027, FloatType(), True), # 68th percentile value for the intra-neuron distance distribution\n    StructField(\u0027distance_percentile75\u0027, FloatType(), True), # 75th percentile value for the intra-neuron distance distribution\n    StructField(\u0027distance_percentile95\u0027, FloatType(), True), # 95th percentile value for the intra-neuron distance distribution\n    StructField(\u0027distance_fwhm\u0027, FloatType(), True), # Full Width at Half Maximum value for the intra-neuron distance distribution\n    StructField(\u0027distance_skew\u0027, FloatType(), True), # Skewness value for the intra-neuron distance distribution \n    StructField(\u0027distance_kurtosis\u0027, FloatType(), True), # Kurtosis value for the intra-neuron distance distribution\n    StructField(\u0027distance_i_q_r\u0027, FloatType(), True), # Inter-Quartile Range value for the intra-neuron distance distribution\n    StructField(\u0027distance_fwhm_norm\u0027, FloatType(), True), # Normalized FWHM value for the intra-neuron distance distribution\n    StructField(\u0027quality_category\u0027, ShortType(), True), # Quality category assigned to the neuron, where 0 corresponds to the most homogeneous neurons and 6 to the most heterogeneous ones\n    StructField(\u0027bp_transits_mean\u0027, FloatType(), True), # Mean value of the number of  BP transits for the sources that belong to the neuron\n    StructField(\u0027bp_transits_std_dev\u0027, FloatType(), True), # Standard deviation of the number of BP transits for the sources that belong to the neuron\n    StructField(\u0027bp_transits_min\u0027, FloatType(), True), # Minimum value of the number of BP transits for the sources that belong to the neuron\n    StructField(\u0027bp_transits_max\u0027, FloatType(), True), # Maximum value of the number of BP transits for the sources that belong to the neuron\n    StructField(\u0027rp_transits_mean\u0027, FloatType(), True), # Mean value of the number of  RP transits for the sources that belong to the neuron\n    StructField(\u0027rp_transits_std_dev\u0027, FloatType(), True), # Standard deviation of the number of RP transits for the sources that belong to the neuron\n    StructField(\u0027rp_transits_min\u0027, FloatType(), True), # Minimum value of the number of RP transits for the sources that belong to the neuron\n    StructField(\u0027rp_transits_max\u0027, FloatType(), True), # Maximum value of the number of RP transits for the sources that belong to the neuron\n    StructField(\u0027ruwe_mean\u0027, FloatType(), True), # Mean value of the renormalised unit weight error for the sources that belong to the neuron\n    StructField(\u0027ruwe_std_dev\u0027, FloatType(), True), # Standard deviation of the renormalised unit weight error for the sources that belong to the neuron\n    StructField(\u0027ruwe_min\u0027, FloatType(), True), # Minimum value of the renormalised unit weight error for the sources that belong to the neuron\n    StructField(\u0027ruwe_max\u0027, FloatType(), True), # Maximum value of the renormalised unit weight error for the sources that belong to the neuron\n    StructField(\u0027bprp_mean_flux_excess_mean\u0027, FloatType(), True), # Mean value of the BP/RP flux excess for the sources that belong to the neuron\n    StructField(\u0027bprp_mean_flux_excess_std_dev\u0027, FloatType(), True), # Standard deviation of the BP/RP flux excess for the sources that belong to the neuron\n    StructField(\u0027bprp_mean_flux_excess_min\u0027, FloatType(), True), # Minimum value of the BP/RP flux excess for the sources that belong to the neuron\n    StructField(\u0027bprp_mean_flux_excess_max\u0027, FloatType(), True), # Maximum value of the BP/RP flux excess for the sources that belong to the neuron\n    StructField(\u0027bprp_colour_mean\u0027, FloatType(), True), # Mean value of the $G_{\\rm BP}-G_{\\rm RP}$ colour for the sources that belong to the neuron\n    StructField(\u0027bprp_colour_std_dev\u0027, FloatType(), True), # Standard deviation of the $G_{\\rm BP}-G_{\\rm RP}$ colour for the sources that belong to the neuron\n    StructField(\u0027bprp_colour_min\u0027, FloatType(), True), # Minimum value of the $G_{\\rm BP}-G_{\\rm RP}$ colour for the sources that belong to the neuron\n    StructField(\u0027bprp_colour_max\u0027, FloatType(), True), # Maximum value of the $G_{\\rm BP}-G_{\\rm RP}$ colour for the sources that belong to the neuron\n])\noa_neuron_xp_spectra_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027neuron_id\u0027, LongType(), False), # Neuron identifier\n    StructField(\u0027neuron_row_index\u0027, ShortType(), True), # Row index of the neuron in the Self-Organised Map lattice\n    StructField(\u0027neuron_column_index\u0027, ShortType(), True), # Column index of the neuron in the Self-Organised Map lattice\n    StructField(\u0027xp_spectrum_prototype_flux\u0027, FloatType(), True), # Normalised flux at wavelength {\\tt xpSpectrumPrototypeWavelength} for the preprocessed XP spectrum that best represents the neuron (prototype) \n    StructField(\u0027xp_spectrum_prototype_wavelength\u0027, FloatType(), True), # Wavelength associated with the XP spectrum flux values \n    StructField(\u0027xp_spectrum_template_flux\u0027, FloatType(), True), # Normalised flux at wavelength {\\tt xpSpectrumPrototypeWavelength} for the preprocessed XP spectrum corresponding to the neuron template  \n])\nqso_candidates_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027astrometric_selection_flag\u0027, BooleanType(), True), # Flag indicating if the source is part of the astrometric selection\n    StructField(\u0027gaia_crf_source\u0027, BooleanType(), True), # Flag indicative of whether the source was used define the Gaia-CRF3\n    StructField(\u0027vari_best_class_name\u0027, StringType(), True), # Name of best class, see table VariClassifierClassDefinition for details of the class\n    StructField(\u0027vari_best_class_score\u0027, FloatType(), True), # Score of the best class\n    StructField(\u0027fractional_variability_g\u0027, FloatType(), True), # Fractional variability in the G band\n    StructField(\u0027structure_function_index\u0027, FloatType(), True), # Index of the first-order structure function in the G band\n    StructField(\u0027structure_function_index_scatter\u0027, DoubleType(), True), # Standard deviation of the index of the structure function\n    StructField(\u0027qso_variability\u0027, FloatType(), True), # Quasar variability metric in the G band\n    StructField(\u0027non_qso_variability\u0027, FloatType(), True), # Non-quasar variability metric in the G band\n    StructField(\u0027vari_agn_membership_score\u0027, DoubleType(), True), # Membership score (0\u003dlowest,1\u003dhighest) of source to be of AGN type\n    StructField(\u0027classprob_dsc_combmod_quasar\u0027, FloatType(), True), # Probability from DSC-Combmod of being a quasar (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classprob_dsc_combmod_galaxy\u0027, FloatType(), True), # Probability from DSC-Combmod of being a galaxy (data used: BP/RP spectrum, photometry, astrometry)\n    StructField(\u0027classlabel_dsc\u0027, StringType(), True), # Class assigned by DSC based on the probability from its Combmod classifier\n    StructField(\u0027classlabel_dsc_joint\u0027, StringType(), True), # Class assigned by DSC based on the probability from its Specmod and Allosmod classifiers\n    StructField(\u0027classlabel_oa\u0027, StringType(), True), # Class assigned by OA the neuron that represents the source\n    StructField(\u0027redshift_qsoc\u0027, FloatType(), True), # Redshift from QSOC\n    StructField(\u0027redshift_qsoc_lower\u0027, FloatType(), True), # Redshift lower confidence level from QSOC\n    StructField(\u0027redshift_qsoc_upper\u0027, FloatType(), True), # Redshift upper confidence level from QSOC\n    StructField(\u0027ccfratio_qsoc\u0027, FloatType(), True), # Value of the cross-correlation function used to derive the redshift from QSOC, relative to the maximum value\n    StructField(\u0027zscore_qsoc\u0027, FloatType(), True), # Redshift zscore from QSOC\n    StructField(\u0027flags_qsoc\u0027, LongType(), True), # Processing flags for the analysis based on BP/RP Spectra from QSOC\n    StructField(\u0027n_transits\u0027, IntegerType(), True), # Number of transits used for the morphological analysis\n    StructField(\u0027intensity_quasar\u0027, DoubleType(), True), # Fitted intensity of the quasar at its center\n    StructField(\u0027intensity_quasar_error\u0027, DoubleType(), True), # Error on the fitted intensity of the quasar at its center\n    StructField(\u0027intensity_hostgalaxy\u0027, DoubleType(), True), # Fitted intensity of the host galaxy at the effective radius\n    StructField(\u0027intensity_hostgalaxy_error\u0027, DoubleType(), True), # Error on the fitted intensity of the host galaxy at effective radius\n    StructField(\u0027radius_hostgalaxy\u0027, DoubleType(), True), # Fitted effective radius of the host galaxy\n    StructField(\u0027radius_hostgalaxy_error\u0027, DoubleType(), True), # Error on the fitted effective radius of the host galaxy\n    StructField(\u0027sersic_index\u0027, FloatType(), True), # Fitted sersic Index\n    StructField(\u0027sersic_index_error\u0027, FloatType(), True), # Error on the fitted sersic Index\n    StructField(\u0027ellipticity_hostgalaxy\u0027, DoubleType(), True), # Fitted ellipticity of the host galaxy\n    StructField(\u0027ellipticity_hostgalaxy_error\u0027, DoubleType(), True), # Error on the fitted ellipticity of the host galaxy\n    StructField(\u0027posangle_hostgalaxy\u0027, DoubleType(), True), # Fitted position angle of the host galaxy\n    StructField(\u0027posangle_hostgalaxy_error\u0027, DoubleType(), True), # Error on the fitted position angle of the host galaxy\n    StructField(\u0027host_galaxy_detected\u0027, BooleanType(), True), # Flag indicating whether a host galaxy has been detected\n    StructField(\u0027l2_norm\u0027, DoubleType(), True), # L2 norm for the fitted Sersic profile\n    StructField(\u0027morph_params_corr_vec\u0027, ArrayType(DoubleType()), True), # Vector form of the upper triangle of the correlation matrix for the fitted morphological parameters\n    StructField(\u0027host_galaxy_flag\u0027, ByteType(), True), # Flag indicative of processing or scientific quality for the morphological parameters fitting\n    StructField(\u0027source_selection_flags\u0027, IntegerType(), True), # Bit indicative of whether the input data from a given module met the source list eligibility criteria for the source of interest\n])\nqso_catalogue_name_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027catalogue_id\u0027, ByteType(), False), # The unique identifier for the catalogue(s) used to select the sources in the morphological analysis\n])\nrvs_mean_spectrum_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right Ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027flux\u0027, ArrayType(FloatType()), True), # array of fluxes\n    StructField(\u0027flux_error\u0027, ArrayType(FloatType()), True), # array of uncertainties in flux\n    StructField(\u0027combined_transits\u0027, ShortType(), True), # number of combined transits\n    StructField(\u0027combined_ccds\u0027, ShortType(), True), # number of combined CCD spectra\n    StructField(\u0027deblended_ccds\u0027, ShortType(), True), # number of deblended CCD spectra \n])\nscience_alerts_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027transit_id\u0027, LongType(), False), # Alerting transit identifier\n    StructField(\u0027name\u0027, StringType(), True), # Name of alert\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n])\nsso_observation_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source identifier\n    StructField(\u0027denomination\u0027, StringType(), True), # standard MPC denomination of the asteroid\n    StructField(\u0027transit_id\u0027, LongType(), True), # Transit Identifier\n    StructField(\u0027observation_id\u0027, LongType(), True), # Observation Identifier\n    StructField(\u0027number_mp\u0027, LongType(), True), # Minor Planet number\n    StructField(\u0027epoch\u0027, DoubleType(), False), # Gaia-centric epoch TCB(Gaia)\n    StructField(\u0027epoch_err\u0027, DoubleType(), True), # Error in Gaiacentric epoch\n    StructField(\u0027epoch_utc\u0027, DoubleType(), True), # Gaia-centric TCB epoch converted to UTC\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right ascension of the source\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination of the source\n    StructField(\u0027ra_error_systematic\u0027, DoubleType(), True), # Standard error of right ascension - systematic\n    StructField(\u0027dec_error_systematic\u0027, DoubleType(), True), # Standard error of declination - systematic\n    StructField(\u0027ra_dec_correlation_systematic\u0027, DoubleType(), True), # Correlation of ra and dec errors - systematic\n    StructField(\u0027ra_error_random\u0027, DoubleType(), True), # Standard error of right ascension - random\n    StructField(\u0027dec_error_random\u0027, DoubleType(), True), # Standard error of declination - random\n    StructField(\u0027ra_dec_correlation_random\u0027, DoubleType(), True), # Correlation of ra and dec errors - random\n    StructField(\u0027g_mag\u0027, DoubleType(), True), # Calibrated G mag\n    StructField(\u0027g_flux\u0027, DoubleType(), True), # Average calibrated G flux for the transit\n    StructField(\u0027g_flux_error\u0027, DoubleType(), True), # Error on the G flux\n    StructField(\u0027x_gaia\u0027, DoubleType(), True), # Barycentric x position of Gaia\n    StructField(\u0027y_gaia\u0027, DoubleType(), True), # Barycentric y position of Gaia\n    StructField(\u0027z_gaia\u0027, DoubleType(), True), # Barycentric z position of Gaia\n    StructField(\u0027vx_gaia\u0027, DoubleType(), True), # Barycentric x velocity of Gaia\n    StructField(\u0027vy_gaia\u0027, DoubleType(), True), # Barycentric y velocity of Gaia\n    StructField(\u0027vz_gaia\u0027, DoubleType(), True), # Barycentric z velocity of Gaia\n    StructField(\u0027x_gaia_geocentric\u0027, DoubleType(), True), # Geocentric x position of Gaia\n    StructField(\u0027y_gaia_geocentric\u0027, DoubleType(), True), # Geocentric y position of Gaia\n    StructField(\u0027z_gaia_geocentric\u0027, DoubleType(), True), # Geocentric z position of Gaia\n    StructField(\u0027vx_gaia_geocentric\u0027, DoubleType(), True), # Geocentric x velocity of Gaia\n    StructField(\u0027vy_gaia_geocentric\u0027, DoubleType(), True), # Geocentric y velocity of Gaia\n    StructField(\u0027vz_gaia_geocentric\u0027, DoubleType(), True), # Geocentric z velocity of Gaia\n    StructField(\u0027position_angle_scan\u0027, DoubleType(), True), # Position angle of the scanning direction \n    StructField(\u0027astrometric_outcome_ccd\u0027, ArrayType(IntegerType()), True), # Result of processing the CCDs\n    StructField(\u0027astrometric_outcome_transit\u0027, IntegerType(), True), # Result of processing the transit\n])\nsso_reflectance_spectrum_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Source identifier\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027number_mp\u0027, LongType(), True), # Minor Planet number\n    StructField(\u0027denomination\u0027, StringType(), True), # standard MPC denomination of the asteroid\n    StructField(\u0027nb_samples\u0027, ShortType(), True), # Nb samples in spectrum\n    StructField(\u0027num_of_spectra\u0027, IntegerType(), True), # number of epoch spectra used to compute the average\n    StructField(\u0027reflectance_spectrum\u0027, FloatType(), True), # Reflectance spectrum\n    StructField(\u0027reflectance_spectrum_err\u0027, FloatType(), True), # Error in reflectance spectrum\n    StructField(\u0027wavelength\u0027, FloatType(), True), # Internally-calibrated wavelength of reflectance spectrum\n    StructField(\u0027reflectance_spectrum_flag\u0027, ByteType(), True), # Reflectance spectrum value flag\n])\nsso_source_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), False), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Source identifier\n    StructField(\u0027num_of_obs\u0027, IntegerType(), True), # number of observations\n    StructField(\u0027number_mp\u0027, LongType(), True), # Minor Planet number\n    StructField(\u0027denomination\u0027, StringType(), True), # standard MPC denomination of the asteroid\n    StructField(\u0027num_of_spectra\u0027, IntegerType(), True), # Number of epoch spectra used to compute the average\n])\ntotal_galactic_extinction_map_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027healpix_id\u0027, LongType(), False), # HEALPix identification\n    StructField(\u0027healpix_level\u0027, ByteType(), True), # HEALPix level used \n    StructField(\u0027a0\u0027, FloatType(), True), # Mean $A_0$ extinction parameter\n    StructField(\u0027a0_uncertainty\u0027, FloatType(), True), # Uncertainty for the mean $A_0$\n    StructField(\u0027a0_min\u0027, FloatType(), True), # Minimum $A_0$ value used for the HEALPix of interest\n    StructField(\u0027a0_max\u0027, FloatType(), True), # Maximum $A_0$ value used for the HEALPix of interest\n    StructField(\u0027num_tracers_used\u0027, IntegerType(), True), # Number of tracers used\n    StructField(\u0027optimum_hpx_flag\u0027, BooleanType(), True), # Flag to indicate whether a given HEALPix level is the optimum (True) or not (False)\n    StructField(\u0027status\u0027, ShortType(), True), # Exit status for TGE\n])\ntotal_galactic_extinction_map_opt_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027healpix_id\u0027, LongType(), False), # HEALPix identification\n    StructField(\u0027a0\u0027, FloatType(), True), # Median A$_0$ extinction parameter\n    StructField(\u0027a0_uncertainty\u0027, FloatType(), True), # Uncertainty for the mean A$_0$\n    StructField(\u0027num_tracers_used\u0027, IntegerType(), True), # Number of tracers used\n    StructField(\u0027status\u0027, ShortType(), True), # Exit status for TGE\n    StructField(\u0027optimum_hpx_level\u0027, ByteType(), True), # Number indicating which HEALPix level was chosen to populate this HEALPix\n])\nvari_agn_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027fractional_variability_g\u0027, FloatType(), True), # Fractional variability in the G band\n    StructField(\u0027structure_function_index\u0027, FloatType(), True), # Index of the first-order structure function in the G band\n    StructField(\u0027structure_function_index_scatter\u0027, FloatType(), True), # Standard deviation of the index of the structure function\n    StructField(\u0027qso_variability\u0027, FloatType(), True), # Quasar variability metric in the G band\n    StructField(\u0027non_qso_variability\u0027, FloatType(), True), # Non-quasar variability metric in the G band\n])\nvari_classifier_class_definition_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027classifier_name\u0027, StringType(), False), # Name of the classifier that is detailed in this entry\n    StructField(\u0027class_name\u0027, StringType(), False), # Name of the published class from this classifier\n    StructField(\u0027class_description\u0027, StringType(), True), # Description of the published class from this classifier\n])\nvari_classifier_definition_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027classifier_name\u0027, StringType(), False), # Name of the classifier that is detailed in this entry\n    StructField(\u0027classifier_description\u0027, StringType(), True), # Description of this classifier\n])\nvari_classifier_result_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027classifier_name\u0027, StringType(), False), # Classifier name used to produce this result, use for lookup in \\texttt{VariClassifierDefinition} table\n    StructField(\u0027best_class_name\u0027, StringType(), True), # Name of best class, see table \\texttt{VariClassifierClassDefinition} for details of the class\n    StructField(\u0027best_class_score\u0027, FloatType(), True), # Score of the best class\n])\nvari_compact_companion_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027period\u0027, DoubleType(), True), # Orbital period\n    StructField(\u0027period_error\u0027, FloatType(), True), # Orbital period error\n    StructField(\u0027t0_g\u0027, DoubleType(), True), # G-band reference time\n    StructField(\u0027t0_g_error\u0027, FloatType(), True), # G-band reference time error\n    StructField(\u0027t0_bp\u0027, DoubleType(), True), # BP-band reference time\n    StructField(\u0027t0_bp_error\u0027, FloatType(), True), # BP-band reference time error\n    StructField(\u0027t0_rp\u0027, DoubleType(), True), # RP-band reference time\n    StructField(\u0027t0_rp_error\u0027, FloatType(), True), # RP-band reference time error\n    StructField(\u0027harmonic_model_params_g\u0027, ArrayType(FloatType()), True), # G-band harmonics\n    StructField(\u0027harmonic_model_params_g_error\u0027, ArrayType(FloatType()), True), # G-band harmonics errors\n    StructField(\u0027harmonic_model_params_bp\u0027, ArrayType(FloatType()), True), # BP-band harmonics\n    StructField(\u0027harmonic_model_params_bp_error\u0027, ArrayType(FloatType()), True), # BP-band harmonics errors\n    StructField(\u0027harmonic_model_params_rp\u0027, ArrayType(FloatType()), True), # RP-band harmonics\n    StructField(\u0027harmonic_model_params_rp_error\u0027, ArrayType(FloatType()), True), # RP-band harmonics errors\n    StructField(\u0027model_mean_g\u0027, FloatType(), True), # Harmonics model mean G-band magnitude\n    StructField(\u0027model_mean_g_error\u0027, FloatType(), True), # Harmonics model mean G-band magnitude error\n    StructField(\u0027model_mean_bp\u0027, FloatType(), True), # Harmonics model mean BP-band magnitude\n    StructField(\u0027model_mean_bp_error\u0027, FloatType(), True), # Harmonics model mean BP-band magnitude error\n    StructField(\u0027model_mean_rp\u0027, FloatType(), True), # Harmonics model mean RP-band magnitude\n    StructField(\u0027model_mean_rp_error\u0027, FloatType(), True), # Harmonics model mean RP-band magnitude error\n    StructField(\u0027mod_min_mass_ratio\u0027, FloatType(), True), # Modified minimum mass ratio\n    StructField(\u0027mod_min_mass_ratio_one_sigma\u0027, FloatType(), True), # 15.9 percentile modified minimum mass ratio\n    StructField(\u0027mod_min_mass_ratio_three_sigma\u0027, FloatType(), True), # 0.135 percentile modified minimum mass ratio\n    StructField(\u0027alpha\u0027, FloatType(), True), # alpha ellipsoidal coefficient\n])\nvari_eclipsing_binary_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027global_ranking\u0027, FloatType(), True), # Number between 0 (worst) and 1 (best)\n    StructField(\u0027reference_time\u0027, DoubleType(), True), # Reference time used for the geometric model fit\n    StructField(\u0027frequency\u0027, DoubleType(), True), # Frequency of geometric model of the eclipsing binary light curve\n    StructField(\u0027frequency_error\u0027, FloatType(), True), # Uncertainty of \\texttt{frequency}\n    StructField(\u0027geom_model_reference_level\u0027, FloatType(), True), # Magnitude reference level of geometric model\n    StructField(\u0027geom_model_reference_level_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelReferenceLevel}\n    StructField(\u0027geom_model_gaussian1_phase\u0027, FloatType(), True), # Phase of the Gaussian 1 component\n    StructField(\u0027geom_model_gaussian1_phase_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelGaussian1Phase}\n    StructField(\u0027geom_model_gaussian1_sigma\u0027, FloatType(), True), # Standard deviation [phase] of Gaussian 1 component\n    StructField(\u0027geom_model_gaussian1_sigma_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelGaussian1Sigma}\n    StructField(\u0027geom_model_gaussian1_depth\u0027, FloatType(), True), # Magnitude depth of Gaussian 1 component\n    StructField(\u0027geom_model_gaussian1_depth_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelGaussian1Depth}\n    StructField(\u0027geom_model_gaussian2_phase\u0027, FloatType(), True), # Phase of Gaussian 2 component\n    StructField(\u0027geom_model_gaussian2_phase_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelGaussian2Phase}\n    StructField(\u0027geom_model_gaussian2_sigma\u0027, FloatType(), True), # Standard deviation [phase] of Gaussian 2 component\n    StructField(\u0027geom_model_gaussian2_sigma_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelGaussian2Sigma}\n    StructField(\u0027geom_model_gaussian2_depth\u0027, FloatType(), True), # Magnitude depth of Gaussian2 component\n    StructField(\u0027geom_model_gaussian2_depth_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelGaussian2Depth}\n    StructField(\u0027geom_model_cosine_half_period_amplitude\u0027, FloatType(), True), # Amplitude of the cosine component with half the period of the geometric model\n    StructField(\u0027geom_model_cosine_half_period_amplitude_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelCosineHalfPeriodAmplitude}\n    StructField(\u0027geom_model_cosine_half_period_phase\u0027, FloatType(), True), # Reference phase of the cosine component with half the period of the geometric model\n    StructField(\u0027geom_model_cosine_half_period_phase_error\u0027, FloatType(), True), # Uncertainty of \\texttt{geomModelCosineHalfPeriodPhase}\n    StructField(\u0027model_type\u0027, StringType(), True), # Type of geometrical model of the light curve\n    StructField(\u0027num_model_parameters\u0027, ByteType(), True), # Number of free parameters of the geometric model\n    StructField(\u0027reduced_chi2\u0027, FloatType(), True), # Reduced Chi2 of the geometrical model fit\n    StructField(\u0027derived_primary_ecl_phase\u0027, FloatType(), True), # Primary eclipse: phase at geometrically deepest point \n    StructField(\u0027derived_primary_ecl_phase_error\u0027, FloatType(), True), # Primary eclipse: uncertainty of \\texttt{derivedPrimaryEclPhase}\n    StructField(\u0027derived_primary_ecl_duration\u0027, FloatType(), True), # Primary eclipse: duration [phase fraction]\n    StructField(\u0027derived_primary_ecl_duration_error\u0027, FloatType(), True), # Primary eclipse: uncertainty of \\texttt{derivedPrimaryEclDuration}\n    StructField(\u0027derived_primary_ecl_depth\u0027, FloatType(), True), # Primary eclipse: depth\n    StructField(\u0027derived_primary_ecl_depth_error\u0027, FloatType(), True), # Primary eclipse: uncertainty of \\texttt{derivedPrimaryEclDepth}\n    StructField(\u0027derived_secondary_ecl_phase\u0027, FloatType(), True), # Secondary eclipse: phase at geometrically second deepest point \n    StructField(\u0027derived_secondary_ecl_phase_error\u0027, FloatType(), True), # Secondary eclipse: uncertainty of \\texttt{derivedSecondaryEclPhase}\n    StructField(\u0027derived_secondary_ecl_duration\u0027, FloatType(), True), # Secondary eclipse: duration [phase fraction]\n    StructField(\u0027derived_secondary_ecl_duration_error\u0027, FloatType(), True), # Secondary eclipse: uncertainty of \\texttt{derivedSecondaryEclDuration}\n    StructField(\u0027derived_secondary_ecl_depth\u0027, FloatType(), True), # Secondary eclipse: depth\n    StructField(\u0027derived_secondary_ecl_depth_error\u0027, FloatType(), True), # Secondary eclipse: uncertainty of \\texttt{derivedSecondaryEclDepth}\n])\nvari_epoch_radial_velocity_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027transit_id\u0027, LongType(), True), # Transit unique identifier\n    StructField(\u0027rv_obs_time\u0027, DoubleType(), True), # Observing time of the transit\n    StructField(\u0027radial_velocity\u0027, DoubleType(), True), # Barycentric radial velocity\n    StructField(\u0027radial_velocity_error\u0027, DoubleType(), True), # Barycentric radial velocity error\n    StructField(\u0027rejected_by_variability\u0027, BooleanType(), True), # Rejected by DPAC variability processing (or variability analysis)\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n])\nvari_long_period_variable_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027frequency\u0027, DoubleType(), True), # Frequency of the LPV\n    StructField(\u0027frequency_error\u0027, FloatType(), True), # Error on the frequency\n    StructField(\u0027amplitude\u0027, FloatType(), True), # Amplitude of the LPV variability\n    StructField(\u0027median_delta_wl_rp\u0027, FloatType(), True), # Median of the pseudo-wavelength separations between the two highest peaks in RP spectra \n    StructField(\u0027is_cstar\u0027, BooleanType(), True), # Flag to mark C-stars\n])\nvari_microlensing_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027paczynski0_g0\u0027, FloatType(), True), # G-band magnitude baseline (level 0)\n    StructField(\u0027paczynski0_g0_error\u0027, FloatType(), True), # Error of G-band magnitude baseline (level 0)\n    StructField(\u0027paczynski0_bp0\u0027, FloatType(), True), # BP-band magnitude baseline (level 0)\n    StructField(\u0027paczynski0_bp0_error\u0027, FloatType(), True), # Error of BP-band magnitude baseline (level 0)\n    StructField(\u0027paczynski0_rp0\u0027, FloatType(), True), # RP-band magnitude baseline (level 0)\n    StructField(\u0027paczynski0_rp0_error\u0027, FloatType(), True), # Error of RP-band magnitude baseline (level 0)\n    StructField(\u0027paczynski0_u0\u0027, DoubleType(), True), # Impact parameter (level 0)\n    StructField(\u0027paczynski0_u0_error\u0027, DoubleType(), True), # Error of the impact parameter (level 0)\n    StructField(\u0027paczynski0_te\u0027, FloatType(), True), # Event timescale (level 0)\n    StructField(\u0027paczynski0_te_error\u0027, FloatType(), True), # Error of event timescale (level 0)\n    StructField(\u0027paczynski0_tmax\u0027, DoubleType(), True), # Time of maximum amplification (level 0)\n    StructField(\u0027paczynski0_tmax_error\u0027, DoubleType(), True), # Error of time of maximum amplification (level 0)\n    StructField(\u0027paczynski0_chi2\u0027, FloatType(), True), # Chi square of level 0 Paczynski fit\n    StructField(\u0027paczynski0_chi2_dof\u0027, FloatType(), True), # Reduced chi square of level 0 Paczynski fit\n    StructField(\u0027paczynski1_g0\u0027, FloatType(), True), # G-band magnitude baseline (level 1)\n    StructField(\u0027paczynski1_g0_error\u0027, FloatType(), True), # Error of G-band magnitude baseline (level 1)\n    StructField(\u0027paczynski1_bp0\u0027, FloatType(), True), # BP-band magnitude baseline (level 1)\n    StructField(\u0027paczynski1_bp0_error\u0027, FloatType(), True), # Error of BP-band magnitude baseline (level 1)\n    StructField(\u0027paczynski1_rp0\u0027, FloatType(), True), # RP-band magnitude baseline (level 1)\n    StructField(\u0027paczynski1_rp0_error\u0027, FloatType(), True), # Error of RP-band magnitude baseline (level 1)\n    StructField(\u0027paczynski1_u0\u0027, DoubleType(), True), # Impact parameter (level 1)\n    StructField(\u0027paczynski1_u0_error\u0027, DoubleType(), True), # Error of the impact parameter (level 1)\n    StructField(\u0027paczynski1_te\u0027, FloatType(), True), # Event timescale (level 1)\n    StructField(\u0027paczynski1_te_error\u0027, FloatType(), True), # Error of event timescale (level 1)\n    StructField(\u0027paczynski1_tmax\u0027, DoubleType(), True), # Time of maximum amplification (level 1)\n    StructField(\u0027paczynski1_tmax_error\u0027, DoubleType(), True), # Error of time of maximum amplification (level 1)\n    StructField(\u0027paczynski1_fs_g\u0027, FloatType(), True), # Blending factor in G-band (level 1)\n    StructField(\u0027paczynski1_fs_g_error\u0027, FloatType(), True), # Error of blending factor in G-band (level 1)\n    StructField(\u0027paczynski1_fs_bp\u0027, FloatType(), True), # Blending factor in BP-band (level 1)\n    StructField(\u0027paczynski1_fs_bp_error\u0027, FloatType(), True), # Error of blending factor in BP-band (level 1)\n    StructField(\u0027paczynski1_fs_rp\u0027, FloatType(), True), # Blending factor in RP-band (level 1)\n    StructField(\u0027paczynski1_fs_rp_error\u0027, FloatType(), True), # Error of blending factor in RP-band (level 1)\n    StructField(\u0027paczynski1_chi2\u0027, FloatType(), True), # Chi square of level 1 Paczynski fit\n    StructField(\u0027paczynski1_chi2_dof\u0027, FloatType(), True), # Reduced chi square of level 1 Paczynski fit\n])\nvari_ms_oscillator_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027frequency1\u0027, DoubleType(), True), # Best frequency\n    StructField(\u0027fap_g_freq1\u0027, FloatType(), True), # False alarm probability corresponding to the best frequency\n    StructField(\u0027amplitude_g_freq1\u0027, FloatType(), True), # Half peak-to-peak amplitude in the G band of the best frequency\n    StructField(\u0027phase_g_freq1\u0027, FloatType(), True), # Phase of the oscillation in the G band corresponding to best frequency\n    StructField(\u0027num_harmonics\u0027, ByteType(), True), # Number of significant harmonics of the best frequency\n    StructField(\u0027amplitude_g_freq1_harm2\u0027, FloatType(), True), # Half peak-to-peak amplitude in the G band of the second harmonic of the best frequency\n    StructField(\u0027phase_g_freq1_harm2\u0027, FloatType(), True), # Phase of the oscillation in the G band corresponding to the second harmonic of the best frequency\n    StructField(\u0027amplitude_g_freq1_harm3\u0027, FloatType(), True), # Half peak-to-peak amplitude in the G band of the third harmonic of the best frequency\n    StructField(\u0027phase_g_freq1_harm3\u0027, FloatType(), True), # Phase of the oscillation in the G band corresponding to the third harmonic of the best frequency\n])\nvari_planetary_transit_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027transit_reference_time\u0027, DoubleType(), True), # Mid-transit reference time\n    StructField(\u0027transit_period\u0027, DoubleType(), True), # Most probable transit period\n    StructField(\u0027transit_depth\u0027, FloatType(), True), # Transit depth\n    StructField(\u0027transit_duration\u0027, FloatType(), True), # Transit duration\n    StructField(\u0027num_in_transit\u0027, ByteType(), True), # Number of in-transit observations\n])\nvari_rad_vel_statistics_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027num_selected_rv\u0027, ShortType(), True), # Total number of radial velocity transits selected for variability analysis\n    StructField(\u0027mean_obs_time_rv\u0027, DoubleType(), True), # Mean observation time for radial velocity transits\n    StructField(\u0027time_duration_rv\u0027, FloatType(), True), # Time duration of the time series for radial velocity transits\n    StructField(\u0027min_rv\u0027, FloatType(), True), # Minimum radial velocity\n    StructField(\u0027max_rv\u0027, FloatType(), True), # Maximum radial velocity\n    StructField(\u0027mean_rv\u0027, FloatType(), True), # Mean radial velocity\n    StructField(\u0027median_rv\u0027, FloatType(), True), # Median radial velocity\n    StructField(\u0027range_rv\u0027, FloatType(), True), # Difference between the highest and lowest radial velocity transits\n    StructField(\u0027std_dev_rv\u0027, FloatType(), True), # Square root of the unweighted radial velocity variance\n    StructField(\u0027skewness_rv\u0027, FloatType(), True), # Standardized unweighted radial velocity skewness\n    StructField(\u0027kurtosis_rv\u0027, FloatType(), True), # Standardized unweighted radial velocity kurtosis\n    StructField(\u0027mad_rv\u0027, FloatType(), True), # Median Absolute Deviation (MAD) for radial velocity transits\n    StructField(\u0027abbe_rv\u0027, FloatType(), True), # Abbe value for radial velocity transits\n    StructField(\u0027iqr_rv\u0027, FloatType(), True), # Interquartile range for radial velocity transits\n])\nvari_short_timescale_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier\n    StructField(\u0027amplitude_estimate\u0027, FloatType(), True), # Amplitude estimate of all per-CCD G-band photometry (95th quantile - 5th quantile)\n    StructField(\u0027number_of_fov_transits\u0027, ShortType(), True), # Number of FoV transits with more than 7 CCD measurements after time series cleaning\n    StructField(\u0027mean_of_fov_abbe_values\u0027, FloatType(), True), # Mean of per-FoV Abbe values derived from per-CCD G-band photometry\n    StructField(\u0027variogram_num_points\u0027, ByteType(), True), # Number of selected timescale(s) derived from the variogram\n    StructField(\u0027variogram_char_timescales\u0027, ArrayType(FloatType()), True), # Characteristic timescale(s) of variability\n    StructField(\u0027variogram_values\u0027, ArrayType(DoubleType()), True), # Variogram values associated with the {\\tt variogramCharTimescales}\n    StructField(\u0027frequency\u0027, DoubleType(), True), # Frequency search result for either G CCD, G FoV, BP or RP photometry\n])\nxp_continuous_mean_spectrum_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027bp_basis_function_id\u0027, ShortType(), True), # Identifier defining the set of basis functions for the BP spectrum representation\n    StructField(\u0027bp_degrees_of_freedom\u0027, ShortType(), True), # Degrees of freedom for the BP spectrum representation\n    StructField(\u0027bp_n_parameters\u0027, ByteType(), True), # Number of parameters for the BP spectrum representation\n    StructField(\u0027bp_n_measurements\u0027, ShortType(), True), # Number of measurements used for the BP spectrum generation\n    StructField(\u0027bp_n_rejected_measurements\u0027, ShortType(), True), # Number of rejected measurements in the BP spectrum generation\n    StructField(\u0027bp_standard_deviation\u0027, FloatType(), True), # Standard deviation for the BP spectrum representation\n    StructField(\u0027bp_chi_squared\u0027, FloatType(), True), # Chi squared for the BP spectrum representation\n    StructField(\u0027bp_coefficients\u0027, ArrayType(DoubleType()), True), # Basis function coefficients for the BP spectrum representation\n    StructField(\u0027bp_coefficient_errors\u0027, ArrayType(FloatType()), True), # Basis function coefficient errors for the BP spectrum representation\n    StructField(\u0027bp_coefficient_correlations\u0027, ArrayType(FloatType()), True), # Correlation matrix for BP coefficients\n    StructField(\u0027bp_n_relevant_bases\u0027, ShortType(), True), # Number of bases that are relevant for the representation of this mean BP spectrum\n    StructField(\u0027bp_relative_shrinking\u0027, FloatType(), True), # Measure of the relative shrinking of the coefficient vector when truncation is applied for the mean BP spectrum\n    StructField(\u0027rp_basis_function_id\u0027, ShortType(), True), # Identifier defining the set of basis functions for the BP spectrum representation\n    StructField(\u0027rp_degrees_of_freedom\u0027, ShortType(), True), # Degrees of freedom for the RP spectrum representation\n    StructField(\u0027rp_n_parameters\u0027, ByteType(), True), # Number of parameters for the RP spectrum representation\n    StructField(\u0027rp_n_measurements\u0027, ShortType(), True), # Number of measurements used for the RP spectrum generation\n    StructField(\u0027rp_n_rejected_measurements\u0027, ShortType(), True), # Number of rejected measurements in the RP spectrum generation\n    StructField(\u0027rp_standard_deviation\u0027, FloatType(), True), # Standard deviation for the RP spectrum representation\n    StructField(\u0027rp_chi_squared\u0027, FloatType(), True), # Chi squared for the RP spectrum representation\n    StructField(\u0027rp_coefficients\u0027, ArrayType(DoubleType()), True), # Basis function coefficients for the RP spectrum representation\n    StructField(\u0027rp_coefficient_errors\u0027, ArrayType(FloatType()), True), # Basis function coefficient errors for the RP spectrum representation\n    StructField(\u0027rp_coefficient_correlations\u0027, ArrayType(FloatType()), True), # Correlation matrix for RP coefficients\n    StructField(\u0027rp_n_relevant_bases\u0027, ShortType(), True), # Number of bases that are relevant for the representation of this mean RP spectrum\n    StructField(\u0027rp_relative_shrinking\u0027, FloatType(), True), # Measure of the relative shrinking of the coefficient vector when truncation is applied for the mean RP spectrum\n])\nxp_merge_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027wavelength\u0027, FloatType(), False), # Wavelength\n    StructField(\u0027bp_weight\u0027, FloatType(), True), # BP flux weight\n    StructField(\u0027rp_weight\u0027, FloatType(), True), # RP flux weight\n])\nxp_sampled_mean_spectrum_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right Ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027flux\u0027, ArrayType(FloatType()), True), # mean BP + RP combined spectrum flux\n    StructField(\u0027flux_error\u0027, ArrayType(FloatType()), True), # mean BP + RP combined spectrum flux error\n])\nxp_sampling_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027band\u0027, StringType(), True), # BP or RP photometric band\n    StructField(\u0027wavelength\u0027, FloatType(), False), # Wavelength\n    StructField(\u0027basis_function\u0027, ShortType(), True), # basis function index\n    StructField(\u0027sampling_coefficient\u0027, DoubleType(), True), # sampling matrix coefficient\n])\nxp_summary_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Unique source identifier (unique within a particular Data Release)\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027bp_n_relevant_bases\u0027, ShortType(), True), # Number of bases that are relevant for the representation of this mean BP spectrum\n    StructField(\u0027bp_relative_shrinking\u0027, FloatType(), True), # Measure of the relative shrinking of the coefficient vector when truncation is applied for the mean BP spectrum\n    StructField(\u0027bp_n_measurements\u0027, ShortType(), True), # Number of measurements used for the BP spectrum generation\n    StructField(\u0027bp_n_rejected_measurements\u0027, ShortType(), True), # Number of rejected measurements in the BP spectrum generation\n    StructField(\u0027bp_standard_deviation\u0027, FloatType(), True), # Standard deviation for the BP spectrum representation\n    StructField(\u0027bp_chi_squared\u0027, FloatType(), True), # Chi squared for the BP spectrum representation\n    StructField(\u0027bp_n_transits\u0027, ShortType(), True), # Number of transits contributing to the mean in BP\n    StructField(\u0027bp_n_contaminated_transits\u0027, ShortType(), True), # Number of contaminated transits in BP\n    StructField(\u0027bp_n_blended_transits\u0027, ShortType(), True), # Number of blended transits in BP\n    StructField(\u0027rp_n_relevant_bases\u0027, ShortType(), True), # Number of bases that are relevant for the representation of this mean RP spectrum\n    StructField(\u0027rp_relative_shrinking\u0027, FloatType(), True), # Measure of the relative shrinking of the coefficient vector when truncation is applied for the mean RP spectrum\n    StructField(\u0027rp_n_measurements\u0027, ShortType(), True), # Number of measurements used for the RP spectrum generation\n    StructField(\u0027rp_n_rejected_measurements\u0027, ShortType(), True), # Number of rejected measurements in the RP spectrum generation\n    StructField(\u0027rp_standard_deviation\u0027, FloatType(), True), # Standard deviation for the RP spectrum representation\n    StructField(\u0027rp_chi_squared\u0027, FloatType(), True), # Chi squared for the RP spectrum representation\n    StructField(\u0027rp_n_transits\u0027, ShortType(), True), # Number of transits contributing to the mean in RP\n    StructField(\u0027rp_n_contaminated_transits\u0027, ShortType(), True), # Number of contaminated transits in RP\n    StructField(\u0027rp_n_blended_transits\u0027, ShortType(), True), # Number of blended transits in RP\n])\ncommanded_scan_law_schema \u003d StructType([\n    StructField(\u0027jd_time\u0027, DoubleType(), True), # Time [Julian Date in TCB at Gaia - 2455197.5]\n    StructField(\u0027bjd_fov1\u0027, DoubleType(), True), # Time [Julian Date in TCB at barycentre for FOV1 - 2455197.5]\n    StructField(\u0027bjd_fov2\u0027, DoubleType(), True), # Time [Julian Date in TCB at barycentre for FOV2 - 2455197.5]\n    StructField(\u0027obmt_time\u0027, LongType(), False), # Time at Gaia (OBMT)\n    StructField(\u0027ra_fov1\u0027, FloatType(), True), # Right Ascension of FOV1 centre\n    StructField(\u0027dec_fov1\u0027, FloatType(), True), # Declination of FOV1 centre\n    StructField(\u0027heal_pix_fov1\u0027, IntegerType(), True), # FOV1 HEALPix level 12\n    StructField(\u0027scan_angle_fov1\u0027, FloatType(), True), # Scan position angle of FOV1\n    StructField(\u0027ra_fov2\u0027, FloatType(), True), # Right ascension of FOV2 centre\n    StructField(\u0027dec_fov2\u0027, FloatType(), True), # Declination of FOV2 centre\n    StructField(\u0027heal_pix_fov2\u0027, IntegerType(), True), # FOV2 HEALPix level 12\n    StructField(\u0027scan_angle_fov2\u0027, FloatType(), True), # Scan position angle of FOV2\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n])\nagn_cross_id_schema \u003d StructType([\n    StructField(\u0027source_name_in_catalogue\u0027, StringType(), True), # Identifier in the external catalogue\n    StructField(\u0027source_id\u0027, LongType(), False), # Gaia source identifier\n    StructField(\u0027catalogue_name\u0027, StringType(), True), # Name of the external catalogue\n])\nframe_rotator_source_schema \u003d StructType([\n    StructField(\u0027source_id\u0027, LongType(), False), # Gaia source identifier\n    StructField(\u0027considered_for_reference_frame_orientation\u0027, BooleanType(), True), # Considered for the reference frame orientation\n    StructField(\u0027used_for_reference_frame_orientation\u0027, BooleanType(), True), # Used for the reference frame orientation\n    StructField(\u0027considered_for_reference_frame_spin\u0027, BooleanType(), True), # Considered for the reference frame spin\n    StructField(\u0027used_for_reference_frame_spin\u0027, BooleanType(), True), # Used for the reference frame spin\n])\ngaia_crf3_xm_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Gaia source identifier\n    StructField(\u0027icrf3sx\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in ICRF3 S/X\n    StructField(\u0027icrf3k\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in ICRF3 K\n    StructField(\u0027icrf3xka\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in ICRF3 X/Ka\n    StructField(\u0027icrf_name\u0027, StringType(), True), # The ICRF name of the source\n    StructField(\u0027iers_name\u0027, StringType(), True), # The IERS name of the source\n    StructField(\u0027ocars\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in OCARS\n    StructField(\u0027ocars_name\u0027, StringType(), True), # The name for this source in OCARS\n    StructField(\u0027aw15\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in allWISE\n    StructField(\u0027aw15_name\u0027, StringType(), True), # The name for this source in allWISE\n    StructField(\u0027r90\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in the catalogue R90\n    StructField(\u0027r90_name\u0027, StringType(), True), # The name for this source in R90\n    StructField(\u0027m65\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in Milliquas v6.5\n    StructField(\u0027m65_name\u0027, StringType(), True), # The name for this source in Milliquas v6.5\n    StructField(\u0027c75\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in the catalogue C75\n    StructField(\u0027c75_name\u0027, StringType(), True), # The name for this source in C75\n    StructField(\u0027dr14q\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in the catalogue SDSS DR14Q\n    StructField(\u0027dr14q_name\u0027, StringType(), True), # The name for this source in SDSS DR14Q\n    StructField(\u0027lqac5\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in LQAC-5\n    StructField(\u0027lqac5_name\u0027, StringType(), True), # The name for this source in LQAC-5\n    StructField(\u0027lamost5\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in the LAMOST QSO catalogue\n    StructField(\u0027lamost5_name\u0027, StringType(), True), # The name for this source in the LAMOST QSO catalogue\n    StructField(\u0027lqrf\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in LQRF\n    StructField(\u0027lqrf_name\u0027, StringType(), True), # The name for this source in LQRF\n    StructField(\u0027cat2qz\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in 2QZ\n    StructField(\u0027cat2qz_name\u0027, StringType(), True), # The name for this source in 2QZ\n    StructField(\u0027bzcat5\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in Roma-BZCAT, v5\n    StructField(\u0027bzcat5_name\u0027, StringType(), True), # The name for this source in Roma-BZCAT, v5\n    StructField(\u0027cat2whspj\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in 2WHSPJ\n    StructField(\u0027cat2whspj_name\u0027, StringType(), True), # The name for this source in 2WHSPJ\n    StructField(\u0027alma19\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in the ALMA calibrator catalogue\n    StructField(\u0027alma19_name\u0027, StringType(), True), # The name for this source in the ALMA calibrator catalogue\n    StructField(\u0027guw\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in Gaia-unWISE\n    StructField(\u0027guw_name\u0027, StringType(), True), # The name for this source in Gaia-unWISE\n    StructField(\u0027b19\u0027, BooleanType(), True), # The flag describing if the Gaia-CRF3 source was found in the Gaia DR2 quasar and galaxy classification catalogue\n    StructField(\u0027b19_name\u0027, StringType(), True), # The name for this source in the Gaia DR2 quasar and galaxy classification catalogue\n])\ngaia_source_simulation_schema \u003d StructType([\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Long Identifier\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right Ascension\n    StructField(\u0027ra_error\u0027, FloatType(), True), # Right Ascension error\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027dec_error\u0027, FloatType(), True), # Declination error\n    StructField(\u0027parallax\u0027, FloatType(), True), # Parallax\n    StructField(\u0027parallax_error\u0027, FloatType(), True), # Parallax error\n    StructField(\u0027pmra\u0027, FloatType(), True), # Proper motion in RA\n    StructField(\u0027pmra_error\u0027, FloatType(), True), # Error in RA proper motion\n    StructField(\u0027pmdec\u0027, FloatType(), True), # Proper motion in dec\n    StructField(\u0027pmdec_error\u0027, FloatType(), True), # Error in dec. proper motion\n    StructField(\u0027n_obs_al\u0027, IntegerType(), True), # Number of AL observations\n    StructField(\u0027n_outliers_al\u0027, IntegerType(), True), # Number of outliers AL observations\n    StructField(\u0027phot_g_mean_flux\u0027, FloatType(), True), # Mean G flux\n    StructField(\u0027phot_g_mean_flux_error\u0027, FloatType(), True), # Mean G flux error\n    StructField(\u0027phot_g_mean_mag\u0027, FloatType(), True), # Mean G magnitude\n    StructField(\u0027phot_bp_mean_flux\u0027, FloatType(), True), # Mean BP flux\n    StructField(\u0027phot_bp_mean_flux_error\u0027, FloatType(), True), # Mean BP flux error\n    StructField(\u0027phot_bp_mean_mag\u0027, FloatType(), True), # Mean BP magnitude\n    StructField(\u0027phot_rp_mean_flux\u0027, FloatType(), True), # Mean RP flux\n    StructField(\u0027phot_rp_mean_flux_error\u0027, FloatType(), True), # Mean RP flux error\n    StructField(\u0027phot_rp_mean_mag\u0027, FloatType(), True), # Mean RP magnitude\n    StructField(\u0027phot_rvs_mean_flux\u0027, FloatType(), True), # Mean RVS flux\n    StructField(\u0027phot_rvs_mean_flux_error\u0027, FloatType(), True), # Mean RVS flux error\n    StructField(\u0027phot_rvs_mean_mag\u0027, FloatType(), True), # Mean RVS magnitude\n    StructField(\u0027radial_velocity\u0027, FloatType(), True), # Radial velocity\n    StructField(\u0027radial_velocity_error\u0027, FloatType(), True), # Radial velocity error\n    StructField(\u0027teff\u0027, FloatType(), True), # Effective temperature\n    StructField(\u0027teff_error\u0027, FloatType(), True), # Effective temperature error\n    StructField(\u0027vsini\u0027, FloatType(), True), # v sin i\n    StructField(\u0027vsini_error\u0027, FloatType(), True), # v sin i error\n    StructField(\u0027a0\u0027, FloatType(), True), # Extinction at 550 nm\n    StructField(\u0027a0_error\u0027, FloatType(), True), # Extinction at 550 nm error\n    StructField(\u0027feh\u0027, FloatType(), True), # Iron abundance\n    StructField(\u0027feh_error\u0027, FloatType(), True), # Iron abundance error\n    StructField(\u0027logg\u0027, FloatType(), True), # Surface gravity\n    StructField(\u0027logg_error\u0027, FloatType(), True), # Surface gravity Error\n])\ngaia_universe_model_schema \u003d StructType([\n    StructField(\u0027source_extended_id\u0027, StringType(), True), # Extended source identifier\n    StructField(\u0027source_id\u0027, LongType(), False), # Long Identifier\n    StructField(\u0027solution_id\u0027, LongType(), True), # Solution Identifier\n    StructField(\u0027ra\u0027, DoubleType(), True), # Right Ascension\n    StructField(\u0027dec\u0027, DoubleType(), True), # Declination\n    StructField(\u0027barycentric_distance\u0027, FloatType(), True), # Barycentric distance to the simulated source\n    StructField(\u0027pmra\u0027, FloatType(), True), # Proper motion along right ascension \n    StructField(\u0027pmdec\u0027, FloatType(), True), # Proper motion along declination\n    StructField(\u0027radial_velocity\u0027, FloatType(), True), # Radial Velocity \n    StructField(\u0027mag_g\u0027, FloatType(), True), # Mean Apparent G magnitude\n    StructField(\u0027mag_bp\u0027, FloatType(), True), # Mean Apparent BP magnitude\n    StructField(\u0027mag_rp\u0027, FloatType(), True), # Mean Apparent RP magnitude\n    StructField(\u0027mag_rvs\u0027, FloatType(), True), # Mean Apparent RVS magnitude\n    StructField(\u0027v_i\u0027, FloatType(), True), # (V-I) colour\n    StructField(\u0027mean_absolute_v\u0027, FloatType(), True), # Mean Absolute V magnitude\n    StructField(\u0027ag\u0027, FloatType(), True), # Absorption in G\n    StructField(\u0027av\u0027, FloatType(), True), # Absorption in V\n    StructField(\u0027teff\u0027, FloatType(), True), # Effective temperature\n    StructField(\u0027spectral_type\u0027, StringType(), True), # spectral class + luminosity class\n    StructField(\u0027logg\u0027, FloatType(), True), # Surface gravity\n    StructField(\u0027feh\u0027, FloatType(), True), # Metallicity\n    StructField(\u0027alphafe\u0027, FloatType(), True), # Alpha elements\n    StructField(\u0027mbol\u0027, FloatType(), True), # Absolute bolometric magnitude\n    StructField(\u0027age\u0027, FloatType(), True), # Age\n    StructField(\u0027mass\u0027, FloatType(), True), # Mass\n    StructField(\u0027radius\u0027, FloatType(), True), # Radius\n    StructField(\u0027vsini\u0027, FloatType(), True), # Rotational velocity\n    StructField(\u0027population\u0027, IntegerType(), True), # Population\n    StructField(\u0027has_photocenter_motion\u0027, BooleanType(), True), # Boolean describing if the photocenter has or not motion\n    StructField(\u0027nc\u0027, IntegerType(), True), # Number of components\n    StructField(\u0027nt\u0027, IntegerType(), True), # Total number of object\n    StructField(\u0027semimajor_axis\u0027, FloatType(), True), # Semi major axis \n    StructField(\u0027eccentricity\u0027, FloatType(), True), # Eccentricity\n    StructField(\u0027inclination\u0027, FloatType(), True), # Inclination\n    StructField(\u0027longitude_ascending_node\u0027, FloatType(), True), # Longitude of ascending node\n    StructField(\u0027orbit_period\u0027, FloatType(), True), # Period of the orbit\n    StructField(\u0027periastron_date\u0027, FloatType(), True), # Date of periastron\n    StructField(\u0027periastron_argument\u0027, FloatType(), True), # Periastron argument\n    StructField(\u0027variability_type\u0027, StringType(), True), # Variability type\n    StructField(\u0027variability_amplitude\u0027, FloatType(), True), # Amplitude of variability\n    StructField(\u0027variability_period\u0027, FloatType(), True), # Period of variability\n    StructField(\u0027variability_phase\u0027, FloatType(), True), # Phase of variability\n    StructField(\u0027r_env_r_star\u0027, FloatType(), True), # Envelope characterisic for Be stars\n])\n\n# base folder for all release products\nrelease_folder \u003d \u0027GDR3\u0027\n\n# dictionary of all tables: key is table name, value \u003d tuple(tuple of schema(s), subfolder containing parquet files)\ntable_dict \u003d {\n    ##\u0027vari_time_series_statistics\u0027,\n    ##\u0027alerts_mixedin_sourceids\u0027,\n    #\u0027astrophysical_parameters\u0027 : \n    #    ((astrophysical_parameters_schema), release_folder + \u0027/GDR3_ASTROPHYSICAL_PARAMETERS\u0027),\n    #\u0027astrophysical_parameters_supp\u0027 : \n    #    ((astrophysical_parameters_supp_schema), release_folder + \u0027/GDR3_ASTROPHYSICAL_PARAMETERS_SUPP\u0027),\n    #\u0027epoch_photometry\u0027 : \n    #    ((epoch_photometry_schema), release_folder + \u0027/GDR3_EPOCH_PHOTOMETRY\u0027),\n    \u0027gaia_source\u0027 : \n        ((gaia_source_schema), release_folder + \u0027/GDR3_GAIASOURCE\u0027),\n    ##\u0027galaxy_candidates\u0027,\n    ##\u0027galaxy_catalogue_name\u0027,\n    #\u0027mcmc_samples_gsp_phot\u0027 : \n    #    ((mcmc_samples_gsp_phot_schema), release_folder + \u0027/GDR3_MCMC_SAMPLES_GSP_PHOT\u0027),\n    #\u0027mcmc_samples_msc\u0027 : \n    #    ((mcmc_samples_msc_schema), release_folder + \u0027/GDR3_MCMC_SAMPLES_MSC\u0027),\n    ##\u0027nss_acceleration_astro\u0027,\n    ##\u0027nss_non_linear_spectro\u0027,\n    ##\u0027nss_two_body_orbit\u0027,\n    ##\u0027nss_vim_fl\u0027,\n    #\u0027oa_neuron_information\u0027 : \n    #    ((oa_neuron_information_schema), release_folder + \u0027/GDR3_OA_NEURON_INFORMATION\u0027),\n    #\u0027oa_neuron_xp_spectra\u0027 : \n    #    ((oa_neuron_xp_spectra_schema), release_folder + \u0027/GDR3_OA_NEURON_XP_SPECTRA\u0027),\n    ##\u0027qso_candidates\u0027,\n    ##\u0027qso_catalogue_name\u0027,\n    #\u0027rvs_mean_spectrum\u0027 : \n    #    ((rvs_mean_spectrum_schema), release_folder + \u0027/GDR3_RVS_MEAN_SPECTRUM\u0027),\n    ##\u0027science_alerts\u0027,\n    ##\u0027sso_observation\u0027,\n    ##\u0027sso_reflectance_spectrum\u0027,\n    ##\u0027sso_source\u0027,\n    #\u0027total_galactic_extinction_map\u0027 : \n    #    ((total_galactic_extinction_map_schema), release_folder + \u0027/GDR3_TOTAL_GALACTIC_EXTINCTION_MAP\u0027),\n    #\u0027total_galactic_extinction_map_opt\u0027 : \n    #    ((total_galactic_extinction_map_opt_schema), release_folder + \u0027/GDR3_TOTAL_GALACTIC_EXTINCTION_MAP_OPT\u0027),\n    ##\u0027vari_agn\u0027,\n    ##\u0027vari_classifier_class_definition\u0027,\n    ##\u0027vari_classifier_definition\u0027,\n    ##\u0027vari_classifier_result\u0027,\n    ##\u0027vari_compact_companion\u0027,\n    ##\u0027vari_eclipsing_binary\u0027,\n    ##\u0027vari_epoch_radial_velocity\u0027,\n    ##\u0027vari_long_period_variable\u0027,\n    ##\u0027vari_microlensing\u0027,\n    ##\u0027vari_ms_oscillator\u0027,\n    ##\u0027vari_planetary_transit\u0027,\n    ##\u0027vari_rad_vel_statistics\u0027,\n    ##\u0027vari_short_timescale\u0027,\n    \u0027xp_continuous_mean_spectrum\u0027 : \n        ([xp_continuous_mean_spectrum_schema], release_folder + \u0027/GDR3_XP_CONTINUOUS_MEAN_SPECTRUM\u0027),\n    #\u0027xp_sampled_mean_spectrum\u0027 : \n    #    ([xp_sampled_mean_spectrum_schema], release_folder + \u0027/GDR3_XP_SAMPLED_MEAN_SPECTRUM\u0027),\n    #\u0027xp_summary\u0027 : \n    #    ([xp_summary_schema], release_folder + \u0027/GDR3_XP_SUMMARY\u0027),\n    ##\u0027commanded_scan_law\u0027,\n    ##\u0027agn_cross_id\u0027,\n    ##\u0027frame_rotator_source\u0027,\n    ##\u0027gaia_crf3_xm\u0027,\n    ##\u0027gaia_source_simulation\u0027 : \n    ##    ([gaia_source_simulation_schema], release_folder + \u0027/GDR3_GAIA_SOURCE_SIMULATION\u0027),\n    ##\u0027gaia_universe_model\u0027 : \n    ##    ([gaia_universe_model_schema], release_folder + \u0027/GDR3_UNIVERSE_MODEL\u0027),\n}\n# ... small tables doubly commented out;\n# tables that should be ingested but that have not been ingested yet owing to ingest issues are singly commented; \n# TODO decide later what to include.\n\n\n",
      "user": "nch",
      "dateUpdated": "2022-07-07 10:43:28.886",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656962919631_1356285229",
      "id": "paragraph_1656962919631_1356285229",
      "dateCreated": "2022-07-04 19:28:39.631",
      "dateStarted": "2022-07-07 10:43:28.898",
      "dateFinished": "2022-07-07 10:43:28.964",
      "status": "FINISHED"
    },
    {
      "title": "Functions",
      "text": "%pyspark\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql import functions as f\nfrom pyspark.sql import *\n\n# number of buckets for our platform\nNUM_BUCKETS \u003d 2048\n\nspark \u003d SparkSession.builder.getOrCreate()\n\n# root data store path: TODO change this to the official one when established.\ndata_store \u003d \"file:////data/gaia/\"  # \"file:////user/nch/PARQUET/REPARTITIONED/\"\n\n# default key by which to bucket and sort: Gaia catalogue source UID \ndefault_key \u003d \"source_id\"\n\n# Save a dataframe to a set of bucketed parquet files, repartitioning beforehand and sorting (by default by source UID) within the buckets:\ndef saveToBinnedParquet(df, outputParquetPath, name, mode \u003d \"error\", buckets \u003d NUM_BUCKETS, bucket_and_sort_key \u003d default_key):\n    \u0027\u0027\u0027\n    Save a data frame to a set of bucketed parquet files, repartitioning beforehand and sorting\n    (by default on DPAC Gaia source UID) within the buckets.\n    \n    Parameters\n    ----------\n    df : DataFrame\n        (mandatory) the data frame to be written to the persistent file store\n    outputParquetPath : str\n        (mandatory) the absolute path name of the folder to contain the files\n    mode : str\n        (optional) the mode for the underlying DataFrame write method (default : error, i.e. no silent failures)\n    buckets : int\n        (optional) the number of buckets (if in doubt leave as the default)\n    bucket_and_sort_key : str\n        (optional) the bucketing and sorting key for the keyed/clustered data (default source_id; you must specify\n        an alternative if the data frame does not have this column present)\n    \u0027\u0027\u0027\n    df \u003d df.repartition(buckets, bucket_and_sort_key)\n    df.write.format(\"parquet\") \\\n            .mode(mode) \\\n            .bucketBy(buckets, bucket_and_sort_key) \\\n            .sortBy(bucket_and_sort_key) \\\n            .option(\"path\", outputParquetPath) \\\n            .saveAsTable(name)\n\ndef reattachParquetFileResourceToSparkContext(table_name, file_path, schema_structures, cluster_key \u003d default_key, sort_key \u003d default_key, buckets \u003d NUM_BUCKETS):\n\t\"\"\"\n\tCreates a Spark (in-memory) meta-record for the table resource specified for querying\n\tthrough the PySpark SQL API.\n\tDefault assumption is that the table contains the Gaia source_id attribute and that the files have\n\tbeen previously partitioned, bucketed and sorted on this field in parquet format\n\t- see function saveToBinnedParquet().  If the table name specified already exists in the\n\tcatalogue IT WILL BE REMOVED (but the underlying data, assumed external, will remain).\n\tParameters\n\t----------\n\ttable_name : str\n\t\tThe table name to be used as the identifier in SQL queries etc.\n\tfile_path : str\n\t\tThe full disk file system path name to the folder containing the parquet file set.\n\tschema_structures : StructType\n\t\tOne or more schema structures expressed as a StructType object containing a list of\n\t\tStructField(field_name : str, type : data_type : DataType(), nullable : boolean)\n\tcluster_key : str (optional)\n\t    The clustering key (\u003d bucketing and sort key) in the partitioned data set on disk. \n\t    Default is Gaia catalogue source UID (\u003d source_id).\n\tsort_key : str (optional)\n\t    The sorting key within buckets in the partitioned data set on disk. \n\t    Default is Gaia catalogue source UID (\u003d source_id).\n\tbuckets : int (optional)\n\t    Number of buckets into which the data is organised.\n\t\"\"\"\n\n\t# put in the columns and their data types ...\n\ttable_create_statement \u003d \"CREATE TABLE `\" + table_name + \"` (\"\n\tfor schema_structure in schema_structures:\n\t\tfor field in schema_structure:\n\t\t\ttable_create_statement +\u003d \"`\" + field.name + \"` \" + field.dataType.simpleString() + \",\"\n\t# ... zapping that extraneous comma at the end\n\ttable_create_statement \u003d table_create_statement[:-1]\n\n\t# append the organisational details\n\ttable_create_statement +\u003d \") USING parquet OPTIONS (path \u0027\" + file_path + \"\u0027) \"\n\ttable_create_statement +\u003d \"CLUSTERED BY (%s) SORTED BY (%s) INTO %d\" % (\n\t\tcluster_key, sort_key, buckets) + \" BUCKETS\"\n\n\n\t# scrub any existing record - N.B. tables defined in this way are EXTERNAL, so this statement will not scrub\n\t# the underlying file data set. Also if the table doesn\u0027t exist, this will silently do nothing (no exception\n\t# will be thrown).\n\tspark.sql(\"DROP TABLE IF EXISTS \" + table_name)\n\n\t# create the table resource\n\tspark.sql(table_create_statement)\n\nimport copy\n\ndef create_interim_schema_for_csv(schema_structure):\n    \u0027\u0027\u0027\n    Takes a schema StructType() and substitutes all array types as a string in order\n    to create a schema against which csv files can be read into an interim data frame\n    prior to conversion of the comma-separated string of numerical values into an array\n    of the appropriate numeric type.\n    \n    Parameters\n    ----------\n    schema_structure : StructType\n        the table schema containing array types \n        \n    Returns: StructType\n    -------------------\n    An edited version of the given schema with all ArrayType changed to StringType\n    \u0027\u0027\u0027\n    \n    # new interim structure\n    interim_structure \u003d StructType()\n    \n    # iterate over the schema, copying in everything and substituting strings for any arrays\n    for field in schema_structure:\n        interim_field \u003d copy.deepcopy(field)\n        if type(interim_field.dataType) \u003d\u003d ArrayType: interim_field.dataType \u003d StringType()\n        interim_structure.add(interim_field)\n    \n    return interim_structure\n\ndef cast_to_array(data_frame : DataFrame, column_name : str, data_type : DataType):\n    \"\"\"\n    Casts the specified string column in the given data frame into an\n    array with the specified data type. Assumes the string column contains\n    comma-separated values in plain text delimited by braces (which are\n    ignored). The array column is appended to the existing column set while \n    the original string column is removed. The resulting data frame will\n    contain an array column with the same name as the original string\n    data column.\n    \n    Parameters:\n    -----------\n    data_frame : DataFrame()\n        The PySpark data frame instance to be operated on\n    column_name : str\n        The column name that contains the array data as a plain text string of \n        comma-separated values\n    data_type : DataType()\n        The PySpark data structure data type which should be ArrayType(SomeType())\n        \n    Returns:\n    --------\n    a new data frame containing the requested modification\n    \"\"\"\n    \n    # a temporary working column name for the array\n    temporary_column_name \u003d column_name + \u0027_array_data\u0027\n    \n    # reformat the string csv data as an array of the specified type\n    data_frame \u003d data_frame.withColumn(temporary_column_name, f.split(f.col(column_name).substr(f.lit(2), f.length(f.col(column_name)) - 2), \u0027,\u0027).cast(data_type))\n    \n    # drop the original string column to save space\n    data_frame \u003d data_frame.drop(column_name)\n    \n    # rename the temporary column with the original column name\n    data_frame \u003d data_frame.withColumnRenamed(temporary_column_name, column_name)\n    \n    return data_frame\n    \n    \ndef reorder_columns(data_frame : DataFrame, data_structure : StructType):\n    \"\"\"\n    Reorder the columns according to the Gaia archive public schema and so that\n    the parquet files can be re-attached against that standard schema.\n    \n    Parameters:\n    -----------\n    data_frame : DataFrame()\n        The PySpark data frame instance to be operated on\n    data_structure : StructType()\n        The PySpark data structure containing the required schema definition\n    \"\"\"\n    \n    # use the schema to define the column order\n    ordered_columns \u003d [field.name for field in data_structure]\n    \n    # give it back in the schema-driven order\n    return data_frame.select(ordered_columns)\n    \n\ndef cast_all_arrays(data_frame : DataFrame, data_structure : StructType):\n    \"\"\"\n    Given an interim data frame read from csv and containing arrays in\n    plain text string representation, cycles over the schema transforming\n    all strings associated with arrays into the required primitive type.\n    \n    Parameters:\n    -----------\n    data_frame : DataFrame()\n        The PySpark data frame instance to be operated on\n    data_structure : StructType()\n        The PySpark data structure containing the required schema definition\n    \"\"\"\n    \n    # cycle over the defined fields looking for arrays\n    for field in data_structure:\n        \n        # if it\u0027s an array type then transmogrify:\n        if type(field.dataType) \u003d\u003d ArrayType: \n            data_frame \u003d cast_to_array(data_frame, field.name, field.dataType)\n    \n    # finally reorder according to the original specification\n    return reorder_columns(data_frame, data_structure)\n    ",
      "user": "nch",
      "dateUpdated": "2022-07-07 10:43:30.815",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656963729552_964111560",
      "id": "paragraph_1656963729552_964111560",
      "dateCreated": "2022-07-04 19:42:09.552",
      "dateStarted": "2022-07-07 10:43:30.822",
      "dateFinished": "2022-07-07 10:43:30.876",
      "status": "FINISHED"
    },
    {
      "title": "Attach gaiadr3.gaia_source",
      "text": "%pyspark\n\n# just in case\nspark.sql(\"USE gaiadr3\")\n\n# if required\n#spark.sql(\"DROP TABLE gaia_source_test\")\n\n# attach gaiadr3.gaia_source\nreattachParquetFileResourceToSparkContext(table_name \u003d \u0027gaia_source\u0027, file_path \u003d \u0027file:////data/gaia/GDR3/GDR3_GAIASOURCE/\u0027, schema_structures \u003d (gaia_source_schema,))\n",
      "user": "nch",
      "dateUpdated": "2022-07-07 10:43:32.555",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656963817956_1455393140",
      "id": "paragraph_1656963817956_1455393140",
      "dateCreated": "2022-07-04 19:43:37.956",
      "dateStarted": "2022-07-07 10:43:32.570",
      "dateFinished": "2022-07-07 10:43:32.749",
      "status": "FINISHED"
    },
    {
      "title": "Attach gaiadr3.xp_continuous_mean_spectrum",
      "text": "%pyspark\n\n# just in case (again)\nspark.sql(\"USE gaiadr3\")\n\n# attach gaiadr3.xp_continuous_mean_spectrum\nreattachParquetFileResourceToSparkContext(table_name \u003d \u0027xp_continuous_mean_spectrum\u0027, file_path \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_XP_CONTINUOUS_MEAN_SPECTRUM/\u0027, schema_structures \u003d (xp_continuous_mean_spectrum_schema,))\n\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-05 14:44:34.667",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656963844019_131207019",
      "id": "paragraph_1656963844019_131207019",
      "dateCreated": "2022-07-04 19:44:04.019",
      "dateStarted": "2022-07-05 14:44:34.670",
      "dateFinished": "2022-07-05 14:44:35.081",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\n# check they\u0027re in\nspark.sql(\"SHOW TABLES\").show()",
      "user": "anonymous",
      "dateUpdated": "2022-07-05 15:15:41.010",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----------+\n|database|           tableName|isTemporary|\n+--------+--------------------+-----------+\n| gaiadr3|         gaia_source|      false|\n| gaiadr3|xp_continuous_mea...|      false|\n+--------+--------------------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656964239219_63100639",
      "id": "paragraph_1656964239219_63100639",
      "dateCreated": "2022-07-04 19:50:39.219",
      "dateStarted": "2022-07-05 15:15:41.013",
      "dateFinished": "2022-07-05 15:15:41.042",
      "status": "FINISHED"
    },
    {
      "title": "SQL context test",
      "text": "%pyspark\n\nimport gaiadmpsetup\n\nspark.sql(\"SHOW TABLES\").show()\n\n# ... set up does not switch context, so we can run tests on DR3 gaia_source in the pre-existing gaiadr3 context.\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-05 09:41:06.413",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----------+\n|database|           tableName|isTemporary|\n+--------+--------------------+-----------+\n| gaiadr3|         gaia_source|      false|\n| gaiadr3|    gaia_source_test|      false|\n| gaiadr3|xp_continuous_mea...|      false|\n|        |  classified_sources|       true|\n|        |         raw_sources|       true|\n+--------+--------------------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656964526458_793242638",
      "id": "paragraph_1656964526458_793242638",
      "dateCreated": "2022-07-04 19:55:26.458",
      "dateStarted": "2022-07-05 09:41:06.417",
      "dateFinished": "2022-07-05 09:41:06.449",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\n#spark.sql(\"REFRESH TABLE gaia_source\")\n\nspark.sql(\"select count(*) from gaia_source_test\").show()\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 16:21:50.628",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656964662343_1844862045",
      "id": "paragraph_1656964662343_1844862045",
      "dateCreated": "2022-07-04 19:57:42.343",
      "dateStarted": "2022-07-04 20:15:52.455",
      "dateFinished": "2022-07-04 20:15:52.795",
      "status": "ERROR"
    },
    {
      "title": "Epoch photometry ingest attempt",
      "text": "%pyspark\n\n# interim structure for the above with strings for the arrays\ninterim_schema \u003d create_interim_schema_for_csv(epoch_photometry_schema)\n\n# read the csv files against the interim schema\ngdr3_epphot_df \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).option(\u0027escape\u0027,\u0027\"\u0027).schema(interim_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Photometry/epoch_photometry/*.csv\u0027)\n\n# cast the string arrays to arrays of numeric types\nrecast_df \u003d cast_all_arrays(gdr3_epphot_df,epoch_photometry_schema)\n\n# write out to partitioned, bucketed parquet\n#gaiadmpstore.\nsaveToBinnedParquet(recast_df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_EPOCH_PHOTOMETRY/\u0027, name \u003d \u0027epoch_photometry\u0027)\n\n# success in 9min 43 sec (60 GB parquet)",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 16:24:12.171",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d11"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d12"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657032390302_1439779250",
      "id": "paragraph_1657032390302_1439779250",
      "dateCreated": "2022-07-05 14:46:30.302",
      "dateStarted": "2022-07-06 11:59:53.689",
      "dateFinished": "2022-07-06 12:09:36.377",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nspark.sql(\"SHOW TABLES\").show()\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 16:31:35.975",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----------+\n|database|           tableName|isTemporary|\n+--------+--------------------+-----------+\n| gaiadr3|    epoch_photometry|      false|\n| gaiadr3|         gaia_source|      false|\n| gaiadr3|   rvs_mean_spectrum|      false|\n| gaiadr3|xp_continuous_mea...|      false|\n+--------+--------------------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657103719215_536692135",
      "id": "paragraph_1657103719215_536692135",
      "dateCreated": "2022-07-06 10:35:19.215",
      "dateStarted": "2022-07-06 16:31:35.980",
      "dateFinished": "2022-07-06 16:31:36.003",
      "status": "FINISHED"
    },
    {
      "title": "rvs_mean_spectrum",
      "text": "%pyspark\n\n# interim structure for the above with strings for the arrays\ninterim_schema \u003d create_interim_schema_for_csv(rvs_mean_spectrum_schema)\n\n# read the csv files against the interim schema\ndf \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).schema(interim_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Spectroscopy/rvs_mean_spectrum/*.csv\u0027)\n\n# cast the string arrays to arrays of numeric types\nrecast_df \u003d cast_all_arrays(df, rvs_mean_spectrum_schema)\n\n# write out to partitioned, bucketed parquet\n#gaiadmpstore.\nsaveToBinnedParquet(recast_df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_RVS_MEAN_SPECTRUM/\u0027, name \u003d \u0027rvs_mean_spectrum\u0027)\n\n# success in 3min 1 sec",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 16:37:33.358",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d13"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d14"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657103723805_1066118570",
      "id": "paragraph_1657103723805_1066118570",
      "dateCreated": "2022-07-06 10:35:23.805",
      "dateStarted": "2022-07-06 16:28:17.294",
      "dateFinished": "2022-07-06 16:31:18.518",
      "status": "FINISHED"
    },
    {
      "title": "xp_summary",
      "text": "%pyspark\n\n# read the csv files against the schema\ndf \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).schema(xp_summary_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Spectroscopy/xp_summary/*.csv\u0027)\n\n# write out to partitioned, bucketed parquet\n#gaiadmpstore.\nsaveToBinnedParquet(df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_XP_SUMMARY/\u0027, name \u003d \u0027xp_summary\u0027)\n\n# success in 2min 21 sec",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 16:37:47.641",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d15"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d16"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657124897293_2007210767",
      "id": "paragraph_1657124897293_2007210767",
      "dateCreated": "2022-07-06 16:28:17.293",
      "dateStarted": "2022-07-06 16:34:16.825",
      "dateFinished": "2022-07-06 16:36:37.167",
      "status": "FINISHED"
    },
    {
      "title": "xp_sampled_mean_spectrum",
      "text": "%pyspark\n\n# interim structure for the above with strings for the arrays\ninterim_schema \u003d create_interim_schema_for_csv(xp_sampled_mean_spectrum_schema)\n\n# read the csv files against the interim schema\ndf \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).schema(interim_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Spectroscopy/xp_sampled_mean_spectrum/*.csv\u0027)\n\n# cast the string arrays to arrays of numeric types\nrecast_df \u003d cast_all_arrays(df, xp_sampled_mean_spectrum_schema)\n\n# write out to partitioned, bucketed parquet\n#gaiadmpstore.\nsaveToBinnedParquet(recast_df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_XP_SAMPLED_MEAN_SPECTRUM/\u0027, name \u003d \u0027xp_sampled_mean_spectrum\u0027)\n\n# success in 9 min 35 sec",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 16:58:28.365",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d17"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d18"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657125256824_960933949",
      "id": "paragraph_1657125256824_960933949",
      "dateCreated": "2022-07-06 16:34:16.824",
      "dateStarted": "2022-07-06 16:38:55.150",
      "dateFinished": "2022-07-06 16:48:30.689",
      "status": "FINISHED"
    },
    {
      "title": "astrophysical_parameters",
      "text": "%pyspark\n\n# read the csv files against the schema\ndf \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).schema(astrophysical_parameters_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Astrophysical_parameters/astrophysical_parameters/*.csv\u0027)\n\n# write out to partitioned, bucketed parquet\nsaveToBinnedParquet(df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_ASTROPHYSICAL_PARAMETERS/\u0027, name \u003d \u0027astrophysical_parameters\u0027)\n\n# success in 1 hr 4 min 52 sec",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 19:50:30.316",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d0"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d1"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657125535149_1871959410",
      "id": "paragraph_1657125535149_1871959410",
      "dateCreated": "2022-07-06 16:38:55.149",
      "dateStarted": "2022-07-06 18:15:58.436",
      "dateFinished": "2022-07-06 19:20:50.474",
      "status": "FINISHED"
    },
    {
      "title": "astrophysical_parameters_supp",
      "text": "%pyspark\n\n# read the csv files against the schema\ndf \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).schema(astrophysical_parameters_supp_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Astrophysical_parameters/astrophysical_parameters_supp/*.csv\u0027)\n\n# write out to partitioned, bucketed parquet\nsaveToBinnedParquet(df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_ASTROPHYSICAL_PARAMETERS_SUPP/\u0027, name \u003d \u0027astrophysical_parameters_supp\u0027)\n\n# success in 19 min 38 sec",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 20:20:06.089",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d0"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d1"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657127226594_133344566",
      "id": "paragraph_1657127226594_133344566",
      "dateCreated": "2022-07-06 17:07:06.594",
      "dateStarted": "2022-07-06 19:55:20.251",
      "dateFinished": "2022-07-06 20:14:58.288",
      "status": "FINISHED"
    },
    {
      "title": "mcmc_samples_msc",
      "text": "%pyspark\n\n# interim structure for the above with strings for the arrays\ninterim_schema \u003d create_interim_schema_for_csv(mcmc_samples_msc_schema)\n\n# read the csv files against the interim schema\ndf \u003d sqlContext.read.option(\u0027mode\u0027,\u0027failfast\u0027).option(\u0027comment\u0027, \u0027#\u0027).option(\u0027header\u0027,\u0027true\u0027).option(\u0027nullValue\u0027,\u0027null\u0027).schema(interim_schema).csv(\u0027file:////user/nch/CSV/GDR3/cdn.gea.esac.esa.int/Gaia/gdr3/Astrophysical_parameters/mcmc_samples_msc/*.csv\u0027)\n\n# cast the string arrays to arrays of numeric types\nrecast_df \u003d cast_all_arrays(df, mcmc_samples_msc_schema)\n\n# write out to partitioned, bucketed parquet\nsaveToBinnedParquet(recast_df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_MCMC_SAMPLES_MSC/\u0027, name \u003d \u0027mcmc_samples_msc\u0027)\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-06 20:20:33.735",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "Fail to execute line 13: saveToBinnedParquet(recast_df, outputParquetPath \u003d \u0027file:////user/nch/PARQUET/GDR3/GDR3_MCMC_SAMPLES_MSC/\u0027, name \u003d \u0027mcmc_samples_msc\u0027)\nTraceback (most recent call last):\n  File \"/tmp/1657138620932-0/zeppelin_python.py\", line 158, in \u003cmodule\u003e\n    exec(code, _zcUserQueryNameSpace)\n  File \"\u003cstdin\u003e\", line 13, in \u003cmodule\u003e\n  File \"\u003cstdin\u003e\", line 44, in saveToBinnedParquet\n  File \"/opt/spark/python/pyspark/sql/readwriter.py\", line 1158, in saveAsTable\n    self._jwrite.saveAsTable(name)\n  File \"/opt/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\", line 1303, in __call__\n    answer \u003d self.gateway_client.send_command(command)\n  File \"/opt/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\", line 1033, in send_command\n    response \u003d connection.send_command(command)\n  File \"/opt/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\", line 1200, in send_command\n    answer \u003d smart_decode(self.stream.readline()[:-1])\n  File \"/usr/lib64/python3.7/socket.py\", line 589, in readinto\n    return self._sock.recv_into(b)\n  File \"/opt/spark/python/pyspark/context.py\", line 285, in signal_handler\n    raise KeyboardInterrupt()\nKeyboardInterrupt\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d0"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d1"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657137320250_1713446867",
      "id": "paragraph_1657137320250_1713446867",
      "dateCreated": "2022-07-06 19:55:20.250",
      "dateStarted": "2022-07-06 20:20:33.740",
      "dateFinished": "2022-07-07 07:37:13.734",
      "status": "ABORT"
    },
    {
      "text": "%pyspark\n\nsqlContext.clearCache()\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-07 07:41:46.272",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657138833739_49519018",
      "id": "paragraph_1657138833739_49519018",
      "dateCreated": "2022-07-06 20:20:33.739",
      "status": "READY"
    },
    {
      "text": "%pyspark\n\nimport pandas\n",
      "user": "nch",
      "dateUpdated": "2022-07-07 10:47:19.555",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657190830467_2049405480",
      "id": "paragraph_1657190830467_2049405480",
      "dateCreated": "2022-07-07 10:47:10.467",
      "dateStarted": "2022-07-07 10:47:19.568",
      "dateFinished": "2022-07-07 10:47:19.735",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n",
      "user": "nch",
      "dateUpdated": "2022-07-07 10:47:19.567",
      "progress": 0,
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657190839567_730997308",
      "id": "paragraph_1657190839567_730997308",
      "dateCreated": "2022-07-07 10:47:19.567",
      "status": "READY"
    }
  ],
  "name": "DR3 stop gap set up",
  "id": "2H8DBD36G",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}