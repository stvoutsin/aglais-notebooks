{
  "paragraphs": [
    {
      "text": "%pyspark\n\nspark.conf.set(\"spark.sql.execution.arrow.pyspark.enabled\", \"true\")\n\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-07 15:11:35.501",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657204101510_234082295",
      "id": "paragraph_1657204101510_234082295",
      "dateCreated": "2022-07-07 14:28:21.510",
      "dateStarted": "2022-07-07 15:11:35.503",
      "dateFinished": "2022-07-07 15:11:35.510",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\nspark.conf.get(\u0027spark.sql.execution.arrow.pyspark.enabled\u0027) # by default this is false.\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-07 15:11:39.219",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u0027true\u0027\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657204116557_1799281005",
      "id": "paragraph_1657204116557_1799281005",
      "dateCreated": "2022-07-07 14:28:36.557",
      "dateStarted": "2022-07-07 15:11:39.221",
      "dateFinished": "2022-07-07 15:11:39.229",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nspark.sql(\u0027SELECT * FROM xp_continuous_mean_spectrum WHERE source_id \u003d 5853498713190525696\u0027).show()\n\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:07:32.500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------+-------------------+--------------------+---------------------+---------------+-----------------+--------------------------+---------------------+--------------+--------------------+---------------------+---------------------------+-------------------+---------------------+--------------------+---------------------+---------------+-----------------+--------------------------+---------------------+--------------+--------------------+---------------------+---------------------------+-------------------+---------------------+\n|          source_id|        solution_id|bp_basis_function_id|bp_degrees_of_freedom|bp_n_parameters|bp_n_measurements|bp_n_rejected_measurements|bp_standard_deviation|bp_chi_squared|     bp_coefficients|bp_coefficient_errors|bp_coefficient_correlations|bp_n_relevant_bases|bp_relative_shrinking|rp_basis_function_id|rp_degrees_of_freedom|rp_n_parameters|rp_n_measurements|rp_n_rejected_measurements|rp_standard_deviation|rp_chi_squared|     rp_coefficients|rp_coefficient_errors|rp_coefficient_correlations|rp_n_relevant_bases|rp_relative_shrinking|\n+-------------------+-------------------+--------------------+---------------------+---------------+-----------------+--------------------------+---------------------+--------------+--------------------+---------------------+---------------------------+-------------------+---------------------+--------------------+---------------------+---------------+-----------------+--------------------------+---------------------+--------------+--------------------+---------------------+---------------------------+-------------------+---------------------+\n|5853498713190525696|4545469030156206080|                  56|                 4646|             55|             4701|                        19|            1.1224667|     5853.6416|[56947.0369684017...| [55.701263, 47.49...|       [0.7158656, 0.154...|                 53|                  1.0|                  57|                 5639|             55|             5694|                       137|            1.3151282|      9753.002|[735186.215709665...| [284.91925, 199.7...|       [0.17973025, 0.50...|                 40|           0.99999994|\n+-------------------+-------------------+--------------------+---------------------+---------------+-----------------+--------------------------+---------------------+--------------+--------------------+---------------------+---------------------------+-------------------+---------------------+--------------------+---------------------+---------------+-----------------+--------------------------+---------------------+--------------+--------------------+---------------------+---------------------------+-------------------+---------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d0"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d1"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d2"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d3"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d4"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d5"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657204534145_1924371490",
      "id": "paragraph_1657204534145_1924371490",
      "dateCreated": "2022-07-07 14:35:34.145",
      "dateStarted": "2022-07-08 13:07:32.503",
      "dateFinished": "2022-07-08 13:07:43.102",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nimport gaiadmpsetup\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:06:53.724",
      "progress": 0,
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657206645124_777325471",
      "id": "paragraph_1657206645124_777325471",
      "dateCreated": "2022-07-07 15:10:45.124",
      "dateStarted": "2022-07-08 13:06:53.727",
      "dateFinished": "2022-07-08 13:07:28.978",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\ndef tablesExist(expected_tables, database):\n\n\tcheck \u003d False\n\t\n\ttry:\n\t\n\t\tspark.sql(\"use \" + database)\n\t\tactual_tables \u003d [i.name for i in spark.catalog.listTables()]\n\t\tcheck \u003d  all(item in actual_tables for item in expected_tables)\n\t\n\texcept AnalysisException: pass\n\t\t\n\treturn check\n\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:17:35.013",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657285613727_1511824113",
      "id": "paragraph_1657285613727_1511824113",
      "dateCreated": "2022-07-08 13:06:53.727",
      "dateStarted": "2022-07-08 13:17:35.015",
      "dateFinished": "2022-07-08 13:17:35.023",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nfrom gaiadmpsetup import gaiaedr3_pyspark_schema_structures as edr3\nfrom gaiadmpsetup import gaiadr3_pyspark_schema_structures as dr3\n\ntablesExist(dr3.table_dict.keys(), \"gaiadr3\")\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:20:18.508",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "True\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d34"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d35"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d36"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d37"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d38"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d39"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d40"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286275547_596344586",
      "id": "paragraph_1657286275547_596344586",
      "dateCreated": "2022-07-08 13:17:55.547",
      "dateStarted": "2022-07-08 13:20:18.511",
      "dateFinished": "2022-07-08 13:20:18.771",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nspark.catalog.listTables()\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:18:46.627",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[Table(name\u003d\u0027gaia_source\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027gaia_source_allwise_best_neighbours\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027gaia_source_ps1_best_neighbours\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027gaia_source_tmasspsc_best_neighbours\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d22"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d23"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d24"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d25"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286321459_114286425",
      "id": "paragraph_1657286321459_114286425",
      "dateCreated": "2022-07-08 13:18:41.459",
      "dateStarted": "2022-07-08 13:18:46.630",
      "dateFinished": "2022-07-08 13:18:46.734",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nedr3.table_dict.keys()",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:19:05.164",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "dict_keys([\u0027astrophysical_parameters\u0027, \u0027astrophysical_parameters_supp\u0027, \u0027gaia_source\u0027, \u0027rvs_mean_spectrum\u0027, \u0027xp_continuous_mean_spectrum\u0027, \u0027xp_sampled_mean_spectrum\u0027, \u0027xp_summary\u0027])\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286340589_304947033",
      "id": "paragraph_1657286340589_304947033",
      "dateCreated": "2022-07-08 13:19:00.589",
      "dateStarted": "2022-07-08 13:19:05.167",
      "dateFinished": "2022-07-08 13:19:05.175",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n\nfrom gaiadmpsetup import gaiadr3_pyspark_schema_structures as edr3\n\n# check EDR3\ndatabase \u003d \"gaiaedr3\"\nif not tablesExist(edr3.table_dict.keys(), database):\n\n\t# create the database and switch the current SQL database context to it (from default)\n\t#spark.sql(\"create database if not exists \" + database)\n\tspark.sql(\"use \" + database)\n\n\t# create the tables against their corresponding file sets and schema\n\tfor table_key in edr3.table_dict.keys():\n\t\tfolder_path \u003d edr3.table_dict[table_key][1]\n\t\tschemas \u003d edr3.table_dict[table_key][0]\n\t\t#reattachParquetFileResourceToSparkContext(table_key, data_store + folder_path, schemas)\n\t\t\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:17:02.996",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286194356_1058442955",
      "id": "paragraph_1657286194356_1058442955",
      "dateCreated": "2022-07-08 13:16:34.356",
      "status": "READY"
    },
    {
      "text": "%pyspark\n\n# check DR3\ndatabase \u003d \"gaiadr3\"\nif not tablesExist(dr3.table_dict.keys(), database):\n\n\t# ... similarly for Gaia DR3\n\t#spark.sql(\"create database if not exists \" + database)\n\tspark.sql(\"use \" + database)\n\n\t# create the tables against their corresponding file sets and schema            \n\tfor table_key in dr3.table_dict.keys():\n\t\tfolder_path \u003d dr3.table_dict[table_key][1]\n\t\tschemas \u003d dr3.table_dict[table_key][0]\n\t\t#reattachParquetFileResourceToSparkContext(table_key, data_store + folder_path, schemas)\n\n# finally always leave the PySpark SQL context in the most recent Gaia DR3 database\nspark.sql(\"use gaiadr3\")\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:17:10.509",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286223106_1589425102",
      "id": "paragraph_1657286223106_1589425102",
      "dateCreated": "2022-07-08 13:17:03.106",
      "status": "READY"
    },
    {
      "text": "%pyspark\n\nspark.sql(\"use gaiadr3\")\n\nspark.catalog.listTables()\n\n\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:16:03.866",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[Table(name\u003d\u0027astrophysical_parameters\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027astrophysical_parameters_supp\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027gaia_source\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027rvs_mean_spectrum\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027xp_continuous_mean_spectrum\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027xp_sampled_mean_spectrum\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse), Table(name\u003d\u0027xp_summary\u0027, database\u003d\u0027gaiadr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d11"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d12"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d13"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d14"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d15"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d16"
            },
            {
              "jobUrl": "http://zeppelin:4040/jobs/job?id\u003d17"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286118988_1935969441",
      "id": "paragraph_1657286118988_1935969441",
      "dateCreated": "2022-07-08 13:15:18.988",
      "dateStarted": "2022-07-08 13:16:03.868",
      "dateFinished": "2022-07-08 13:16:04.055",
      "status": "FINISHED"
    },
    {
      "text": "%pyspark\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 13:15:52.773",
      "progress": 0,
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657286152773_410645063",
      "id": "paragraph_1657286152773_410645063",
      "dateCreated": "2022-07-08 13:15:52.773",
      "status": "READY"
    },
    {
      "text": "%md\n\nhere we go...\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 14:34:53.850",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003ehere we go\u0026hellip;\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657290798553_1582850986",
      "id": "paragraph_1657290798553_1582850986",
      "dateCreated": "2022-07-08 14:33:18.553",
      "dateStarted": "2022-07-08 14:34:53.851",
      "dateFinished": "2022-07-08 14:34:56.429",
      "status": "FINISHED"
    },
    {
      "text": "%md\n",
      "user": "nch",
      "dateUpdated": "2022-07-08 14:33:30.423",
      "progress": 0,
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1657290810423_433971395",
      "id": "paragraph_1657290810423_433971395",
      "dateCreated": "2022-07-08 14:33:30.423",
      "status": "READY"
    }
  ],
  "name": "sandbox",
  "id": "2H7DE11VJ",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}